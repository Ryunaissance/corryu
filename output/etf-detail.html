<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ETF ìƒì„¸ â€” CORRYU</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
<script src="/i18n.js"></script>
<style>
:root {
  --bg-primary: #0a0d14;
  --bg-card:    rgba(18,22,36,0.92);
  --border:     rgba(255,255,255,0.07);
  --text-primary: #e2e8f0;
  --text-muted:   #64748b;
  --accent:     #3b82f6;
  --accent-glow: rgba(59,130,246,0.25);
}
* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  background: var(--bg-primary);
  color: var(--text-primary);
  font-family: 'Inter', -apple-system, sans-serif;
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}

/* â”€â”€ ê³µí†µ ìœ í‹¸ â”€â”€ */
.glass {
  background: var(--bg-card);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border: 1px solid var(--border);
  border-radius: 14px;
}
.text-gradient {
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text;
}
.gradient-line {
  position: fixed; top: 0; left: 0; right: 0; height: 3px; z-index: 200;
  background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899, #f59e0b);
}

/* â”€â”€ Navbar â”€â”€ */
nav {
  position: fixed; top: 3px; left: 0; right: 0; z-index: 100;
  background: rgba(10,13,20,0.9); backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border); height: 56px;
  display: flex; align-items: center;
}
.nav-inner {
  max-width: 1320px; margin: 0 auto; padding: 0 24px;
  width: 100%; display: flex; align-items: center; gap: 14px;
}
.nav-back {
  display: flex; align-items: center; gap: 6px;
  color: var(--text-muted); font-size: 0.82rem; font-weight: 600;
  text-decoration: none; transition: color 0.15s; white-space: nowrap;
}
.nav-back:hover { color: #60a5fa; }
.nav-sep { color: #1e293b; }
.nav-brand {
  font-size: 0.95rem; font-weight: 900; text-decoration: none; white-space: nowrap;
}
.nav-search {
  flex: 1; max-width: 320px; margin-left: auto;
  display: flex; align-items: center; gap: 0;
  background: rgba(255,255,255,0.04); border: 1px solid var(--border);
  border-radius: 8px; overflow: hidden;
}
.nav-search input {
  flex: 1; background: none; border: none; outline: none;
  color: var(--text-primary); font-size: 0.82rem; font-family: inherit;
  padding: 7px 10px;
}
.nav-search input::placeholder { color: var(--text-muted); }
.nav-search button {
  background: none; border: none; color: var(--text-muted);
  padding: 7px 10px; cursor: pointer; font-size: 0.85rem;
  transition: color 0.15s;
}
.nav-search button:hover { color: var(--text-primary); }

/* â”€â”€ ë©”ì¸ ë ˆì´ì•„ì›ƒ â”€â”€ */
.main-wrap {
  max-width: 1320px; margin: 0 auto;
  padding: 76px 20px 48px;
}

/* â”€â”€ ë¡œë”© / ì—ëŸ¬ â”€â”€ */
#loading-state, #error-state {
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  min-height: 60vh; gap: 16px; text-align: center;
}
.spinner {
  width: 36px; height: 36px; border: 3px solid rgba(255,255,255,0.1);
  border-top-color: var(--accent); border-radius: 50%;
  animation: spin 0.8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* â”€â”€ Hero ì¹´ë“œ â”€â”€ */
.hero-card {
  padding: 28px 32px;
  margin-bottom: 14px;
  position: relative; overflow: hidden;
}
.hero-card::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
}
.hero-grid {
  display: grid; grid-template-columns: 1fr auto;
  gap: 24px; align-items: flex-start;
}
.hero-ticker {
  font-size: 3rem; font-weight: 900; letter-spacing: -0.04em;
  line-height: 1; margin-bottom: 4px;
}
.hero-name {
  font-size: 0.95rem; color: #94a3b8; margin-bottom: 14px; font-weight: 400;
}
.hero-badges { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 16px; }
.badge {
  display: inline-flex; align-items: center; gap: 4px;
  padding: 3px 10px; border-radius: 6px; font-size: 0.73rem; font-weight: 700;
}
.badge-sector  { background: rgba(59,130,246,0.1); color: #60a5fa; border: 1px solid rgba(59,130,246,0.2); }
.badge-active  { background: rgba(74,222,128,0.1); color: #4ade80; border: 1px solid rgba(74,222,128,0.2); }
.badge-legacy  { background: rgba(248,113,113,0.1); color: #f87171; border: 1px solid rgba(248,113,113,0.2); }
.badge-short   { background: rgba(234,179,8,0.1);   color: #facc15; border: 1px solid rgba(234,179,8,0.2); }
.hero-desc { font-size: 0.84rem; color: var(--text-muted); line-height: 1.7; max-width: 600px; }
.hero-price-box { text-align: right; }
.price-label { font-size: 0.72rem; color: var(--text-muted); margin-bottom: 4px; }
.price-na { font-size: 1rem; color: #334155; font-weight: 600; }
.price-note { font-size: 0.7rem; color: #334155; margin-top: 4px; }
.star-hero-btn {
  background: none; border: 1px solid rgba(255,255,255,0.1); cursor: pointer;
  color: #374151; font-size: 1.2rem; padding: 6px 12px; border-radius: 8px;
  transition: all 0.15s; margin-top: 10px; font-family: inherit;
}
.star-hero-btn.starred { color: #fbbf24; border-color: rgba(251,191,36,0.4); background: rgba(251,191,36,0.08); }
.star-hero-btn:hover { color: #fbbf24; border-color: rgba(251,191,36,0.3); }
.compare-hero-btn {
  display: inline-flex; align-items: center; gap: 5px;
  background: none; border: 1px solid rgba(167,139,250,0.25); cursor: pointer;
  color: #a78bfa; font-size: 0.78rem; font-weight: 700; padding: 6px 12px; border-radius: 8px;
  transition: all 0.15s; text-decoration: none; font-family: inherit; margin-top: 10px;
}
.compare-hero-btn:hover { background: rgba(167,139,250,0.1); border-color: rgba(167,139,250,0.5); }

/* â”€â”€ ì§€í‘œ ì´ë ¥ íŠ¸ë Œë“œ â”€â”€ */
.metric-stat-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.metric-current-val { font-size: 1.4rem; font-weight: 900; letter-spacing: -0.03em; }
.metric-ref-dots { display: flex; gap: 10px; flex-wrap: wrap; }
.metric-ref-dot { display: flex; align-items: center; gap: 4px; font-size: 0.7rem; color: var(--text-muted); }

/* â”€â”€ Quick Stats Bar â”€â”€ */
.quick-stats {
  display: grid; grid-template-columns: repeat(5, 1fr);
  gap: 0; margin-bottom: 20px;
  background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px;
  overflow: hidden;
}
.qs-item {
  padding: 14px 16px; text-align: center;
  border-right: 1px solid var(--border);
}
.qs-item:last-child { border-right: none; }
.qs-label { font-size: 0.68rem; color: var(--text-muted); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 5px; }
.qs-value { font-size: 0.95rem; font-weight: 700; }

/* â”€â”€ ì»¨í…ì¸  ê·¸ë¦¬ë“œ â”€â”€ */
.content-grid {
  display: grid;
  grid-template-columns: 3fr 2fr;
  gap: 16px;
  align-items: start;
}
.card { padding: 22px 24px; margin-bottom: 16px; }
.card-title {
  font-size: 0.78rem; font-weight: 700; letter-spacing: 0.06em;
  text-transform: uppercase; color: var(--text-muted); margin-bottom: 18px;
  display: flex; align-items: center; gap: 8px;
}
.card-title::after { content: ''; flex: 1; height: 1px; background: var(--border); }

/* â”€â”€ ì°¨íŠ¸ â”€â”€ */
.chart-tabs {
  display: flex; gap: 4px; margin-bottom: 14px;
}
.chart-tab {
  padding: 4px 12px; border-radius: 6px; font-size: 0.78rem; font-weight: 700;
  border: none; cursor: pointer; background: rgba(255,255,255,0.04);
  color: var(--text-muted); transition: all 0.15s; font-family: inherit;
}
.chart-tab.active {
  background: rgba(59,130,246,0.15); color: #60a5fa;
  border: 1px solid rgba(59,130,246,0.3);
}
.chart-tab:hover:not(.active) { color: var(--text-primary); background: rgba(255,255,255,0.07); }
.chart-stat {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 10px;
}
.chart-pct {
  font-size: 1.5rem; font-weight: 900; letter-spacing: -0.03em;
}
.chart-period-label { font-size: 0.75rem; color: var(--text-muted); }
.chart-container { width: 100%; height: 220px; overflow: hidden; }
.chart-disclaimer {
  font-size: 0.68rem; color: #2d3748; margin-top: 6px; text-align: right;
}

/* â”€â”€ ì„±ê³¼ í…Œì´ë¸” â”€â”€ */
.perf-table { width: 100%; border-collapse: collapse; }
.perf-table th {
  font-size: 0.72rem; color: var(--text-muted); font-weight: 600;
  text-align: left; padding: 6px 0; border-bottom: 1px solid var(--border);
}
.perf-table th:not(:first-child) { text-align: right; }
.perf-table td {
  font-size: 0.85rem; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.03);
}
.perf-table td:not(:first-child) { text-align: right; font-weight: 600; font-variant-numeric: tabular-nums; }
.perf-table tr:last-child td { border-bottom: none; }
.perf-period { color: var(--text-muted); font-size: 0.8rem; }
.ret-pos { color: #4ade80; }
.ret-neg { color: #f87171; }
.ret-na  { color: #334155; }

/* â”€â”€ êµ¬ì„±ì¢…ëª© â”€â”€ */
.holding-row { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
.holding-rank { font-size: 0.68rem; color: #334155; width: 16px; text-align: right; flex-shrink: 0; }
.holding-ticker { font-size: 0.8rem; font-weight: 700; color: #60a5fa; width: 60px; flex-shrink: 0; }
.holding-name { font-size: 0.78rem; color: var(--text-muted); flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.holding-weight { font-size: 0.8rem; font-weight: 700; width: 50px; text-align: right; flex-shrink: 0; }
.holding-bar-wrap { width: 100px; flex-shrink: 0; }
.holding-bar-bg { height: 4px; background: rgba(255,255,255,0.05); border-radius: 2px; overflow: hidden; }
.holding-bar { height: 100%; background: linear-gradient(90deg, #3b82f6, #8b5cf6); border-radius: 2px; }
.holdings-footer {
  margin-top: 14px; padding-top: 12px; border-top: 1px solid var(--border);
  font-size: 0.75rem; color: var(--text-muted); display: flex; justify-content: space-between;
}

/* â”€â”€ ë¶„ì„ ì§€í‘œ â”€â”€ */
.metric-row {
  display: flex; justify-content: space-between; align-items: center;
  padding: 9px 0; border-bottom: 1px solid rgba(255,255,255,0.04);
}
.metric-row:last-child { border-bottom: none; }
.metric-label { font-size: 0.8rem; color: var(--text-muted); }
.metric-value { font-size: 0.88rem; font-weight: 700; font-variant-numeric: tabular-nums; }
.val-pos { color: #f87171; }   /* ê³¼ë§¤ìˆ˜/ë†’ìŒ */
.val-neg { color: #60a5fa; }   /* ê³¼ë§¤ë„/ë‚®ìŒ */
.val-good { color: #4ade80; }  /* ì¢‹ìŒ */
.val-warn { color: #fbbf24; }  /* ì£¼ì˜ */
.val-purple { color: #a78bfa; }
.val-neutral { color: #94a3b8; }

/* ê²Œì´ì§€ ë°” */
.gauge-wrap { display: flex; align-items: center; gap: 6px; }
.gauge-bar { flex: 1; height: 4px; background: rgba(255,255,255,0.06); border-radius: 2px; overflow: hidden; }
.gauge-fill { height: 100%; border-radius: 2px; }

/* â”€â”€ í€ë“œ ì •ë³´ â”€â”€ */
.info-row {
  display: flex; justify-content: space-between; align-items: center;
  padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.04);
  gap: 8px;
}
.info-row:last-child { border-bottom: none; }
.info-label { font-size: 0.78rem; color: var(--text-muted); flex-shrink: 0; }
.info-value { font-size: 0.82rem; font-weight: 600; text-align: right; }

/* â”€â”€ ê¸°ì¤€ì¼ ë…¸íŠ¸ â”€â”€ */
.data-note {
  padding: 14px 18px; border-radius: 10px;
  background: rgba(255,255,255,0.02); border: 1px solid var(--border);
  font-size: 0.75rem; color: var(--text-muted); line-height: 1.7;
}

/* â”€â”€ ë°˜ì‘í˜• â”€â”€ */
@media (max-width: 900px) {
  .content-grid { grid-template-columns: 1fr; }
  .quick-stats { grid-template-columns: repeat(3, 1fr); }
  .quick-stats .qs-item:nth-child(4),
  .quick-stats .qs-item:nth-child(5) { border-top: 1px solid var(--border); }
}
@media (max-width: 600px) {
  .hero-grid { grid-template-columns: 1fr; }
  .hero-ticker { font-size: 2rem; }
  .quick-stats { grid-template-columns: 1fr 1fr; }
  .card { padding: 16px; }
  .hero-card { padding: 20px; }
  .holding-bar-wrap { display: none; }
}
</style>
</head>
<body>

<div class="gradient-line"></div>

<!-- â”€â”€ Navbar â”€â”€ -->
<nav>
  <div class="nav-inner">
    <a href="/index" class="nav-back">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 12H5M12 5l-7 7 7 7"/></svg>
      ëŒ€ì‹œë³´ë“œ
    </a>
    <span class="nav-sep">/</span>
    <a href="/landing" class="nav-brand"><span class="text-gradient">CORRYU</span></a>
    <span id="nav-breadcrumb" style="font-size:0.82rem;color:var(--text-muted)"></span>
    <div style="display:flex;align-items:center;gap:12px;margin-left:auto">
      <a href="/compare" style="font-size:0.78rem;color:var(--text-muted);text-decoration:none;font-weight:600;display:flex;align-items:center;gap:4px" title="ETF ë¹„êµ">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>ë¹„êµ
      </a>
      <a href="/portfolio" style="font-size:0.78rem;color:var(--text-muted);text-decoration:none;font-weight:600;display:flex;align-items:center;gap:4px" title="í¬íŠ¸í´ë¦¬ì˜¤">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 7V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v2"/></svg>í¬íŠ¸í´ë¦¬ì˜¤
      </a>
    </div>
    <div class="nav-search">
      <input type="text" id="nav-search-input" placeholder="ë‹¤ë¥¸ í‹°ì»¤ ê²€ìƒ‰ (ì˜ˆ: QQQ)" autocomplete="off">
      <button onclick="goToTicker()">â†’</button>
    </div>
  </div>
</nav>

<!-- â”€â”€ ë©”ì¸ â”€â”€ -->
<div class="main-wrap">

  <!-- ë¡œë”© ìƒíƒœ -->
  <div id="loading-state">
    <div class="spinner"></div>
    <p style="color:var(--text-muted);font-size:0.85rem">ETF ë°ì´í„° ë¡œë”© ì¤‘â€¦</p>
  </div>

  <!-- ì—ëŸ¬ ìƒíƒœ -->
  <div id="error-state" style="display:none">
    <div style="font-size:2rem">ğŸ”</div>
    <h2 id="error-title" style="font-size:1.1rem;font-weight:700">ETFë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h2>
    <p id="error-msg" style="font-size:0.85rem;color:var(--text-muted)"></p>
    <a href="/index" style="margin-top:12px;padding:8px 20px;border-radius:8px;background:var(--accent);color:white;text-decoration:none;font-size:0.85rem;font-weight:700">â† ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</a>
  </div>

  <!-- ì‹¤ì œ ì½˜í…ì¸  (JSë¡œ í‘œì‹œ) -->
  <div id="page-content" style="display:none">

    <!-- â”€â”€ Hero â”€â”€ -->
    <div class="glass hero-card" id="hero-card">
      <div class="hero-grid">
        <div>
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:2px">
            <div class="hero-ticker" id="h-ticker">â€”</div>
            <button class="star-hero-btn" id="star-hero-btn" onclick="toggleWatchlist()" title="ê´€ì‹¬ì¢…ëª© ì¶”ê°€/ì œê±°">â˜…</button>
            <a href="#" id="compare-hero-link" class="compare-hero-btn" title="ETF ë¹„êµ í˜ì´ì§€ë¡œ ì´ë™">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>ë¹„êµí•˜ê¸°
            </a>
          </div>
          <div class="hero-name" id="h-name">â€”</div>
          <div class="hero-badges" id="h-badges"></div>
          <p class="hero-desc" id="h-desc"></p>
        </div>
        <div class="hero-price-box">
          <div class="price-label">ì‹¤ì‹œê°„ ì‹œì„¸</div>
          <div class="price-na">â€” ì—°ë™ ì˜ˆì •</div>
          <div style="margin-top:12px;text-align:right">
            <div style="font-size:0.72rem;color:var(--text-muted)">AUM</div>
            <div style="font-size:1.1rem;font-weight:800" id="h-aum">â€”</div>
          </div>
          <div class="price-note">ë°ì´í„° ê¸°ì¤€ì¼: <span id="h-datadate">â€”</span></div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ Quick Stats â”€â”€ -->
    <div class="quick-stats" id="quick-stats">
      <div class="qs-item">
        <div class="qs-label">ìˆ˜ìˆ˜ë£Œ (Expense Ratio)</div>
        <div class="qs-value" id="qs-exp">â€”</div>
      </div>
      <div class="qs-item">
        <div class="qs-label">ìµœì´ˆ ìƒì¥ì¼</div>
        <div class="qs-value" id="qs-inception">â€”</div>
      </div>
      <div class="qs-item">
        <div class="qs-label">ë°œí–‰ì‚¬</div>
        <div class="qs-value" id="qs-issuer" style="font-size:0.82rem">â€”</div>
      </div>
      <div class="qs-item">
        <div class="qs-label">ë²¤ì¹˜ë§ˆí¬</div>
        <div class="qs-value" id="qs-bench" style="font-size:0.78rem">â€”</div>
      </div>
      <div class="qs-item">
        <div class="qs-label">êµ¬ì„± ì¢…ëª© ìˆ˜</div>
        <div class="qs-value" id="qs-numh">â€”</div>
      </div>
    </div>

    <!-- â”€â”€ ì»¨í…ì¸  ê·¸ë¦¬ë“œ â”€â”€ -->
    <div class="content-grid">

      <!-- â”€â”€ ì™¼ìª½ ì»¬ëŸ¼ â”€â”€ -->
      <div>

        <!-- ì°¨íŠ¸ ì¹´ë“œ -->
        <div class="glass card">
          <div class="card-title">ì‹œë®¬ë ˆì´ì…˜ ê°€ê²© ì°¨íŠ¸</div>
          <div class="chart-tabs">
            <button class="chart-tab" onclick="switchPeriod('1M',this)">1ê°œì›”</button>
            <button class="chart-tab" onclick="switchPeriod('3M',this)">3ê°œì›”</button>
            <button class="chart-tab" onclick="switchPeriod('6M',this)">6ê°œì›”</button>
            <button class="chart-tab active" onclick="switchPeriod('1Y',this)">1ë…„</button>
          </div>
          <div class="chart-stat">
            <div>
              <div class="chart-pct" id="chart-pct">â€”</div>
              <div class="chart-period-label" id="chart-period-label">1ë…„ ìˆ˜ìµë¥  (ì‹œë®¬ë ˆì´ì…˜)</div>
            </div>
            <div style="text-align:right;font-size:0.75rem;color:var(--text-muted)">
              CAGR <span id="chart-cagr" style="font-weight:700;color:#94a3b8">â€”</span>
              &nbsp;Â·&nbsp; Vol <span id="chart-vol" style="font-weight:700;color:#94a3b8">â€”</span>
            </div>
          </div>
          <div class="chart-container" id="chart-container"></div>
          <div class="chart-disclaimer">
            â€» CAGRÂ·ë³€ë™ì„± ê¸°ë°˜ ì‹œë®¬ë ˆì´ì…˜ ì°¨íŠ¸ì…ë‹ˆë‹¤. ì‹¤ì œ ê°€ê²© ë°ì´í„°ê°€ ì•„ë‹™ë‹ˆë‹¤.
          </div>
        </div>

        <!-- ê¸°ê°„ë³„ ìˆ˜ìµë¥  ì¹´ë“œ -->
        <div class="glass card">
          <div class="card-title">ê¸°ê°„ë³„ ìˆ˜ìµë¥ </div>
          <table class="perf-table">
            <thead>
              <tr>
                <th>ê¸°ê°„</th>
                <th>ìˆ˜ìµë¥ </th>
                <th>ì—°í™˜ì‚°</th>
                <th>ë¹„ê³ </th>
              </tr>
            </thead>
            <tbody id="perf-table-body"></tbody>
          </table>
          <div style="margin-top:10px;font-size:0.7rem;color:#334155">
            â€» ê¸°ê°„ë³„ ìˆ˜ìµë¥ ì€ ì˜ˆì‹œ ë°ì´í„°ì…ë‹ˆë‹¤. ì‹¤ì œ ìˆ˜ìµë¥ ì€ ì¶œì²˜ì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </div>
        </div>

        <!-- ìƒìœ„ êµ¬ì„±ì¢…ëª© ì¹´ë“œ -->
        <div class="glass card">
          <div class="card-title">ìƒìœ„ 10ê°œ êµ¬ì„±ì¢…ëª©</div>
          <div id="holdings-container"></div>
        </div>

        <!-- ì§€í‘œ ì´ë ¥ íŠ¸ë Œë“œ ì¹´ë“œ -->
        <div class="glass card" id="trend-card">
          <div class="card-title">ì§€í‘œ ì´ë ¥ íŠ¸ë Œë“œ (1ë…„ ì‹œë®¬ë ˆì´ì…˜)</div>
          <div class="chart-tabs" style="margin-bottom:12px" id="metric-tabs">
            <button class="chart-tab active" onclick="switchMetric('zscore',this)">Z-Score</button>
            <button class="chart-tab" onclick="switchMetric('rsi',this)">RSI</button>
            <button class="chart-tab" onclick="switchMetric('range52w',this)">52W Range</button>
            <button class="chart-tab" onclick="switchMetric('mdd',this)">MDD</button>
          </div>
          <div class="metric-stat-row">
            <div>
              <span id="metric-current-label" style="font-size:0.75rem;color:var(--text-muted)">í˜„ì¬ Z-Score</span>
              <span class="metric-current-val" id="metric-current-val">â€”</span>
            </div>
            <div class="metric-ref-dots" id="metric-ref-legend"></div>
          </div>
          <div class="chart-container" id="metric-chart-container"></div>
          <div class="chart-disclaimer">â€» ê³¼ê±° 1ë…„ ì§€í‘œ ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°ì…ë‹ˆë‹¤. ì‹¤ì œ ì´ë ¥ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
        </div>

      </div>

      <!-- â”€â”€ ì˜¤ë¥¸ìª½ ì»¬ëŸ¼ â”€â”€ -->
      <div>

        <!-- ë¶„ì„ ì§€í‘œ ì¹´ë“œ -->
        <div class="glass card">
          <div class="card-title">CORRYU ë¶„ì„ ì§€í‘œ</div>
          <div id="metrics-container"></div>
        </div>

        <!-- í€ë“œ ì •ë³´ ì¹´ë“œ -->
        <div class="glass card">
          <div class="card-title">í€ë“œ ê¸°ë³¸ ì •ë³´</div>
          <div id="fund-info-container"></div>
        </div>

        <!-- ë°ì´í„° ê¸°ì¤€ ì•ˆë‚´ -->
        <div class="data-note">
          <div style="font-weight:700;color:#475569;margin-bottom:6px;font-size:0.75rem">ğŸ“‹ ë°ì´í„° ì•ˆë‚´</div>
          <div>ë°ì´í„° ê¸°ì¤€ì¼: <strong id="note-datadate" style="color:#94a3b8">2026-02-26</strong></div>
          <div style="margin-top:4px">Z-ScoreÂ·RSIÂ·52W Range ë“± ë¶„ì„ ì§€í‘œëŠ” CORRYUê°€ ì§ì ‘ ì‚°ì¶œí•œ ìˆ˜ì¹˜ì…ë‹ˆë‹¤.</div>
          <div style="margin-top:4px">ìˆ˜ìˆ˜ë£ŒÂ·êµ¬ì„±ì¢…ëª© ë¹„ìœ¨ì€ ì˜ˆì‹œ ë°ì´í„°ì´ë©°, ì‹¤ì œì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
          <div style="margin-top:4px">ë³¸ ìë£ŒëŠ” íˆ¬ì ê¶Œìœ ê°€ ì•„ë‹™ë‹ˆë‹¤. íˆ¬ì íŒë‹¨ì€ ë³¸ì¸ì˜ ì±…ì„ì…ë‹ˆë‹¤.</div>
        </div>

      </div>
    </div>
  </div><!-- /page-content -->
</div><!-- /main-wrap -->

<script>
// â”€â”€ ë³´ì¡° ë°ì´í„° (ìˆ˜ìˆ˜ë£ŒÂ·ë°œí–‰ì‚¬Â·êµ¬ì„±ì¢…ëª© ë“± etf_data.jsonì— ì—†ëŠ” ì •ë³´) â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SUPP = {
  'SPY':  { exp:'0.0945%', issuer:'State Street Global Advisors', bench:'S&P 500',           structure:'UIT', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.24%', numH:503,
            desc:'S&P 500 ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•˜ëŠ” ì„¸ê³„ ìµœì´ˆÂ·ìµœëŒ€ ê·œëª¨ì˜ ETF. ë¯¸êµ­ ëŒ€í˜•ì£¼ 500ê°œë¥¼ ì‹œê°€ì´ì•¡ ê°€ì¤‘ ë°©ì‹ìœ¼ë¡œ ë³´ìœ í•©ë‹ˆë‹¤.',
            holdings:[['AAPL','Apple Inc.',7.32],['MSFT','Microsoft Corp.',6.81],['NVDA','NVIDIA Corp.',5.94],['AMZN','Amazon.com Inc.',3.78],['META','Meta Platforms',2.65],['GOOGL','Alphabet Class A',2.10],['GOOG','Alphabet Class C',1.82],['BRK.B','Berkshire Hathaway B',1.63],['LLY','Eli Lilly & Co.',1.52],['JPM','JPMorgan Chase',1.47]],
            perf:{'1M':2.3,'3M':5.1,'YTD':8.7,'1Y':22.4,'3Y_ann':12.1,'5Y_ann':14.7} },
  'QQQ':  { exp:'0.20%',  issuer:'Invesco',                       bench:'Nasdaq-100',         structure:'Open-End',  div:'ë¶„ê¸° ë°°ë‹¹', divYield:'0.55%', numH:101,
            desc:'Nasdaq-100 ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•˜ë©° ê¸°ìˆ Â·ì„±ì¥ì£¼ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±ëœ ETF. FAANG ë° ëŒ€í˜• ê¸°ìˆ ì£¼ ë¹„ì¤‘ì´ ë†’ìŠµë‹ˆë‹¤.',
            holdings:[['AAPL','Apple Inc.',9.15],['MSFT','Microsoft Corp.',8.44],['NVDA','NVIDIA Corp.',7.92],['AMZN','Amazon.com Inc.',5.02],['META','Meta Platforms',4.81],['GOOGL','Alphabet Class A',2.72],['GOOG','Alphabet Class C',2.58],['TSLA','Tesla Inc.',2.35],['AVGO','Broadcom Inc.',2.21],['COST','Costco Wholesale',1.86]],
            perf:{'1M':3.1,'3M':7.8,'YTD':12.3,'1Y':28.5,'3Y_ann':15.4,'5Y_ann':19.2} },
  'IVV':  { exp:'0.03%',  issuer:'BlackRock (iShares)',           bench:'S&P 500',             structure:'Open-End',  div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.26%', numH:503,
            desc:'iShares Core S&P 500 ETF. 0.03%ì˜ ìµœì € ìˆ˜ìˆ˜ë£Œë¡œ S&P 500 ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•©ë‹ˆë‹¤.',
            holdings:[['AAPL','Apple Inc.',7.32],['MSFT','Microsoft Corp.',6.81],['NVDA','NVIDIA Corp.',5.94],['AMZN','Amazon.com Inc.',3.78],['META','Meta Platforms',2.65],['GOOGL','Alphabet Class A',2.10],['GOOG','Alphabet Class C',1.82],['BRK.B','Berkshire Hathaway B',1.63],['LLY','Eli Lilly & Co.',1.52],['JPM','JPMorgan Chase',1.47]],
            perf:{'1M':2.3,'3M':5.1,'YTD':8.7,'1Y':22.4,'3Y_ann':12.1,'5Y_ann':14.7} },
  'VOO':  { exp:'0.03%',  issuer:'Vanguard',                      bench:'S&P 500',             structure:'Open-End',  div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.25%', numH:503,
            desc:'Vanguard S&P 500 ETF. ì—…ê³„ ìµœì € ìˆ˜ì¤€ì˜ ìˆ˜ìˆ˜ë£Œë¡œ S&P 500 ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•©ë‹ˆë‹¤.',
            holdings:[['AAPL','Apple Inc.',7.31],['MSFT','Microsoft Corp.',6.80],['NVDA','NVIDIA Corp.',5.93],['AMZN','Amazon.com Inc.',3.77],['META','Meta Platforms',2.64],['GOOGL','Alphabet Class A',2.09],['GOOG','Alphabet Class C',1.81],['BRK.B','Berkshire Hathaway B',1.62],['LLY','Eli Lilly & Co.',1.51],['JPM','JPMorgan Chase',1.46]],
            perf:{'1M':2.3,'3M':5.1,'YTD':8.7,'1Y':22.3,'3Y_ann':12.0,'5Y_ann':14.6} },
  'VTI':  { exp:'0.03%',  issuer:'Vanguard',                      bench:'CRSP US Total Market',structure:'Open-End',  div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.35%', numH:3615,
            desc:'ë¯¸êµ­ ì „ì²´ ì£¼ì‹ ì‹œì¥(ëŒ€í˜•Â·ì¤‘í˜•Â·ì†Œí˜•ì£¼ í¬í•¨)ì— í•œ ë²ˆì— íˆ¬ìí•˜ëŠ” Total Market ETF.',
            holdings:[['AAPL','Apple Inc.',6.42],['MSFT','Microsoft Corp.',5.96],['NVDA','NVIDIA Corp.',5.21],['AMZN','Amazon.com Inc.',3.31],['META','Meta Platforms',2.32],['GOOGL','Alphabet Class A',1.84],['BRK.B','Berkshire Hathaway B',1.64],['GOOG','Alphabet Class C',1.59],['LLY','Eli Lilly & Co.',1.33],['JPM','JPMorgan Chase',1.28]],
            perf:{'1M':2.1,'3M':4.8,'YTD':8.2,'1Y':21.8,'3Y_ann':11.7,'5Y_ann':14.3} },
  'GLD':  { exp:'0.40%',  issuer:'State Street Global Advisors', bench:'LBMA Gold Price',      structure:'Grantor Trust', div:'ë¬´ë°°ë‹¹', divYield:'0%', numH:1,
            desc:'ì‹¤ë¬¼ ê¸ˆ ê°€ê²©ì„ ì¶”ì¢…í•˜ëŠ” ì„¸ê³„ ìµœëŒ€ ê¸ˆ ETF. ì£¼ë‹¹ ì•½ 1/10 íŠ¸ë¡œì´ì˜¨ìŠ¤ì˜ ê¸ˆì„ ë³´ìœ í•©ë‹ˆë‹¤.',
            holdings:[['GOLD','Physical Gold (0.1 oz/share)',100.0]],
            perf:{'1M':1.8,'3M':9.2,'YTD':11.4,'1Y':18.7,'3Y_ann':8.3,'5Y_ann':11.2} },
  'TLT':  { exp:'0.15%',  issuer:'BlackRock (iShares)',           bench:'ICE US Treasury 20+Y', structure:'Open-End', div:'ì›” ë°°ë‹¹', divYield:'4.12%', numH:26,
            desc:'ë§Œê¸° 20ë…„ ì´ìƒ ë¯¸êµ­ ì¥ê¸° êµ­ì±„ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF. ê¸ˆë¦¬ í•˜ë½ ì‹œ ìˆ˜ìµ, ê¸ˆë¦¬ ìƒìŠ¹ ì‹œ ì†ì‹¤ì´ ë‘ë“œëŸ¬ì§‘ë‹ˆë‹¤.',
            holdings:[['UST1','US Treasury 4.500% 2054',15.2],['UST2','US Treasury 4.125% 2054',9.8],['UST3','US Treasury 3.875% 2053',8.7],['UST4','US Treasury 4.250% 2052',7.3],['UST5','US Treasury 3.000% 2048',6.1],['UST6','US Treasury 2.250% 2052',5.4],['UST7','US Treasury 3.625% 2053',5.2],['UST8','US Treasury 1.875% 2051',4.8],['UST9','US Treasury 2.375% 2049',4.3],['UST10','US Treasury 2.875% 2049',3.9]],
            perf:{'1M':-1.2,'3M':-3.4,'YTD':-4.1,'1Y':-8.3,'3Y_ann':-12.4,'5Y_ann':-6.8} },
  'XLK':  { exp:'0.09%',  issuer:'State Street Global Advisors', bench:'S&P Technology Select Sector', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'0.68%', numH:67,
            desc:'S&P 500 ë‚´ ê¸°ìˆ  ì„¹í„° ê¸°ì—…ì„ ëª¨ë‘ ë‹´ì€ ETF. ì†Œí”„íŠ¸ì›¨ì–´Â·í•˜ë“œì›¨ì–´Â·ë°˜ë„ì²´ ê¸°ì—…ì„ í¬í•¨í•©ë‹ˆë‹¤.',
            holdings:[['MSFT','Microsoft Corp.',22.81],['AAPL','Apple Inc.',20.05],['NVDA','NVIDIA Corp.',17.42],['AVGO','Broadcom Inc.',4.62],['ORCL','Oracle Corp.',3.18],['CSCO','Cisco Systems',3.05],['ADBE','Adobe Inc.',2.34],['CRM','Salesforce Inc.',2.21],['ACN','Accenture PLC',2.14],['AMD','Advanced Micro Devices',1.97]],
            perf:{'1M':4.2,'3M':9.8,'YTD':15.4,'1Y':34.2,'3Y_ann':18.6,'5Y_ann':22.8} },
  'XLF':  { exp:'0.09%',  issuer:'State Street Global Advisors', bench:'S&P Financials Select Sector', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.68%', numH:72,
            desc:'S&P 500 ë‚´ ê¸ˆìœµ ì„¹í„°(ì€í–‰Â·ë³´í—˜Â·íˆ¬ìì€í–‰Â·ì¹´ë“œ)ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF.',
            holdings:[['BRK.B','Berkshire Hathaway B',13.24],['JPM','JPMorgan Chase',12.81],['V','Visa Inc.',8.34],['MA','Mastercard Inc.',7.12],['BAC','Bank of America',4.62],['WFC','Wells Fargo',4.21],['GS','Goldman Sachs',3.84],['MS','Morgan Stanley',3.41],['SPGI','S&P Global Inc.',2.95],['BLK','BlackRock Inc.',2.78]],
            perf:{'1M':1.8,'3M':4.2,'YTD':7.1,'1Y':18.4,'3Y_ann':10.2,'5Y_ann':12.1} },
  'XLV':  { exp:'0.09%',  issuer:'State Street Global Advisors', bench:'S&P Healthcare Select Sector', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.42%', numH:63,
            desc:'S&P 500 ë‚´ í—¬ìŠ¤ì¼€ì–´ ì„¹í„°(ì œì•½Â·ë°”ì´ì˜¤Â·ì˜ë£Œê¸°ê¸°Â·ë³´í—˜)ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF.',
            holdings:[['LLY','Eli Lilly & Co.',12.84],['UNH','UnitedHealth Group',11.42],['JNJ','Johnson & Johnson',8.35],['ABBV','AbbVie Inc.',7.23],['MRK','Merck & Co.',6.84],['TMO','Thermo Fisher',4.21],['DHR','Danaher Corp.',3.82],['ABT','Abbott Laboratories',3.41],['PFE','Pfizer Inc.',3.12],['AMGN','Amgen Inc.',2.94]],
            perf:{'1M':0.8,'3M':2.4,'YTD':4.1,'1Y':10.2,'3Y_ann':8.4,'5Y_ann':10.8} },
  'XLE':  { exp:'0.09%',  issuer:'State Street Global Advisors', bench:'S&P Energy Select Sector', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'3.42%', numH:22,
            desc:'S&P 500 ë‚´ ì—ë„ˆì§€ ì„¹í„°(ì •ìœ Â·ê°€ìŠ¤Â·ì •ì œÂ·ì„œë¹„ìŠ¤)ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF.',
            holdings:[['XOM','Exxon Mobil Corp.',23.74],['CVX','Chevron Corp.',18.32],['COP','ConocoPhillips',6.84],['EOG','EOG Resources',5.21],['MPC','Marathon Petroleum',4.87],['SLB','SLB (Schlumberger)',4.62],['PSX','Phillips 66',4.38],['VLO','Valero Energy',3.95],['OXY','Occidental Petroleum',3.42],['KMI','Kinder Morgan',2.87]],
            perf:{'1M':-1.4,'3M':-2.8,'YTD':-3.2,'1Y':4.2,'3Y_ann':22.4,'5Y_ann':16.8} },
  'IWM':  { exp:'0.19%',  issuer:'BlackRock (iShares)',           bench:'Russell 2000',        structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.23%', numH:2000,
            desc:'ë¯¸êµ­ ì†Œí˜•ì£¼ ì•½ 2,000ê°œë¡œ êµ¬ì„±ëœ Russell 2000 ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•©ë‹ˆë‹¤. ë¯¸êµ­ ë‚´ìˆ˜ ê²½ê¸°ì— ë¯¼ê°í•©ë‹ˆë‹¤.',
            holdings:[['SMCI','Super Micro Computer',0.52],['MTSI','MACOM Technology',0.41],['VIRT','Virtu Financial',0.38],['SPSC','SPS Commerce',0.36],['MGNI','Magnite Inc.',0.34],['AEIS','Advanced Energy Ind.',0.33],['TMDX','TransMedics Group',0.32],['SKYW','SkyWest Inc.',0.31],['CTRE','CareTrust REIT',0.30],['HALO','Halozyme Therapeutics',0.29]],
            perf:{'1M':1.2,'3M':3.4,'YTD':5.8,'1Y':14.2,'3Y_ann':6.4,'5Y_ann':9.1} },
  'VEA':  { exp:'0.05%',  issuer:'Vanguard',                      bench:'FTSE Dev. All Cap ex US', structure:'Open-End', div:'ë°˜ê¸° ë°°ë‹¹', divYield:'2.98%', numH:3900,
            desc:'ë¯¸êµ­Â·ìºë‚˜ë‹¤ë¥¼ ì œì™¸í•œ ì„ ì§„êµ­ ì£¼ì‹(ìœ ëŸ½Â·ì¼ë³¸Â·í˜¸ì£¼ ë“±)ì— íˆ¬ìí•˜ëŠ” ETF.',
            holdings:[['NESN','NestlÃ© S.A.',1.82],['ASML','ASML Holding',1.74],['NOVN','Novartis AG',1.41],['RHHBY','Roche Holding',1.38],['SAP','SAP SE',1.35],['TM','Toyota Motor',1.31],['RDSA','Shell plc',1.24],['AZN','AstraZeneca',1.22],['SIE','Siemens AG',1.18],['HSBC','HSBC Holdings',1.14]],
            perf:{'1M':1.8,'3M':4.1,'YTD':6.3,'1Y':10.4,'3Y_ann':5.2,'5Y_ann':7.8} },
  'VWO':  { exp:'0.08%',  issuer:'Vanguard',                      bench:'FTSE Emerging Markets', structure:'Open-End', div:'ë°˜ê¸° ë°°ë‹¹', divYield:'3.42%', numH:5600,
            desc:'ì¤‘êµ­Â·ì¸ë„Â·ë¸Œë¼ì§ˆÂ·í•œêµ­ ë“± ì‹ í¥êµ­ ì£¼ì‹ ì‹œì¥ì— íˆ¬ìí•˜ëŠ” ETF.',
            holdings:[['TSM','Taiwan Semiconductor',5.84],['BABA','Alibaba Group',3.42],['TCS','Tata Consultancy',2.18],['RELI','Reliance Industries',2.04],['PDD','PDD Holdings',1.94],['SMSN','Samsung Electronics',1.87],['JD','JD.com Inc.',1.52],['BIDU','Baidu Inc.',1.41],['INFY','Infosys Ltd.',1.32],['MBT','Mobile TeleSystems',1.24]],
            perf:{'1M':1.4,'3M':3.8,'YTD':5.2,'1Y':8.4,'3Y_ann':2.1,'5Y_ann':4.8} },
  'VNQ':  { exp:'0.13%',  issuer:'Vanguard',                      bench:'MSCI US IMI Real Estate 25/50', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'3.85%', numH:163,
            desc:'ë¯¸êµ­ ë¶€ë™ì‚° íˆ¬ìì‹ íƒ(REITs)ê³¼ ë¶€ë™ì‚° ê´€ë ¨ ê¸°ì—…ì— íˆ¬ìí•˜ëŠ” ETF.',
            holdings:[['PLD','Prologis Inc.',5.91],['AMT','American Tower',4.83],['EQIX','Equinix Inc.',4.12],['WELL','Welltower Inc.',3.47],['SPG','Simon Property Group',3.22],['DLR','Digital Realty',2.98],['PSA','Public Storage',2.76],['O','Realty Income Corp.',2.65],['CCI','Crown Castle',2.41],['WY','Weyerhaeuser',2.14]],
            perf:{'1M':1.4,'3M':3.8,'YTD':4.2,'1Y':12.3,'3Y_ann':2.8,'5Y_ann':7.4} },
  'HYG':  { exp:'0.48%',  issuer:'BlackRock (iShares)',           bench:'iBoxx USD Liquid HY', structure:'Open-End', div:'ì›” ë°°ë‹¹', divYield:'5.82%', numH:1195,
            desc:'ë¯¸êµ­ íˆ¬ê¸°ë“±ê¸‰(í•˜ì´ì¼ë“œ) íšŒì‚¬ì±„ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF. ë†’ì€ ë°°ë‹¹ ìˆ˜ìµë¥ ê³¼ ì‹ ìš© ë¦¬ìŠ¤í¬ê°€ íŠ¹ì§•.',
            holdings:[['HY01','T-Mobile USA 3.875% 2030',0.58],['HY02','Telecom Italia 5.303% 2034',0.45],['HY03','Carnival Corp. 6.000% 2029',0.43],['HY04','Ford Motor 4.750% 2043',0.41],['HY05','CCO Holdings 4.500% 2032',0.38],['HY06','Netflix Inc. 4.875% 2030',0.36],['HY07','Centene Corp. 4.625% 2029',0.35],['HY08','Bausch Health 5.250% 2030',0.33],['HY09','DISH DBS 5.875% 2024',0.32],['HY10','Pitney Bowes 6.350% 2037',0.31]],
            perf:{'1M':0.8,'3M':2.1,'YTD':1.9,'1Y':8.7,'3Y_ann':4.2,'5Y_ann':4.8} },
  'BND':  { exp:'0.03%',  issuer:'Vanguard',                      bench:'Bloomberg US Aggregate', structure:'Open-End', div:'ì›” ë°°ë‹¹', divYield:'3.72%', numH:10418,
            desc:'ë¯¸êµ­ íˆ¬ìë“±ê¸‰ ì±„ê¶Œ ì „ì²´(êµ­ì±„Â·íšŒì‚¬ì±„Â·MBS)ë¥¼ ì¶”ì¢…í•˜ëŠ” ì¢…í•© ì±„ê¶Œ ETF.',
            holdings:[['UST','US Treasury Notes/Bonds',44.21],['GNMA','GNMA (ì •ë¶€ ëª¨ê¸°ì§€)',20.14],['FNMA','Fannie Mae MBS',15.38],['CORP','Investment Grade Corp',12.41],['FHLMC','Freddie Mac MBS',5.83],['ABS','Asset-Backed Securities',2.03]],
            perf:{'1M':0.4,'3M':1.2,'YTD':0.8,'1Y':2.3,'3Y_ann':-1.8,'5Y_ann':0.4} },
  'GBTC': { exp:'1.50%',  issuer:'Grayscale Investments',         bench:'Bitcoin Price',        structure:'Spot BTC ETF', div:'ë¬´ë°°ë‹¹', divYield:'0%', numH:1,
            desc:'ë¯¸êµ­ SEC ìŠ¹ì¸ í˜„ë¬¼ ë¹„íŠ¸ì½”ì¸ ETF. ë¹„íŠ¸ì½”ì¸ì„ ì§ì ‘ ë³´ìœ í•˜ë©°, BTC ê°€ê²©ì„ 1:1ë¡œ ì¶”ì¢…í•©ë‹ˆë‹¤.',
            holdings:[['BTC','Bitcoin (BTC)',100.0]],
            perf:{'1M':12.4,'3M':38.7,'YTD':45.2,'1Y':124.3,'3Y_ann':28.4,'5Y_ann':48.7} },
  'SQQQ': { exp:'0.95%',  issuer:'ProShares',                     bench:'Nasdaq-100 Ã— âˆ’3',      structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'3.21%', numH:0,
            desc:'Nasdaq-100 ì§€ìˆ˜ì˜ ì¼ì¼ ìˆ˜ìµë¥  Ã—âˆ’3ë°°ë¥¼ ì¶”ì¢…í•˜ëŠ” ì¸ë²„ìŠ¤ ë ˆë²„ë¦¬ì§€ ETF. ë‹¨ê¸° í•˜ë½ ë² íŒ…Â·í—¤ì§• ëª©ì .',
            holdings:[],
            perf:{'1M':-8.9,'3M':-21.4,'YTD':-34.2,'1Y':-67.4,'3Y_ann':-42.8,'5Y_ann':-51.3} },
  'PEY':  { exp:'0.53%',  issuer:'Invesco',                       bench:'NASDAQ US Dividend Achievers 50', structure:'Open-End', div:'ì›” ë°°ë‹¹', divYield:'4.87%', numH:50,
            desc:'ë¯¸êµ­ ê³ ë°°ë‹¹ ìš°ëŸ‰ì£¼ 50ê°œë¥¼ ì„ ë³„í•´ ë°°ë‹¹ ì„±ì¥ ì‹¤ì ì— ë”°ë¼ íˆ¬ìí•˜ëŠ” ETF. ì›” ë°°ë‹¹ì´ íŠ¹ì§•.',
            holdings:[['ALT','Altria Group Inc.',2.42],['T','AT&T Inc.',2.35],['LEG','Leggett & Platt',2.31],['UVV','Universal Corp.',2.28],['HEP','Holly Energy Partners',2.24],['BKH','Black Hills Corp.',2.21],['ESS','Essex Property Trust',2.18],['OHI','Omega Healthcare',2.15],['LAMR','Lamar Advertising',2.12],['NNN','National Retail Prop.',2.09]],
            perf:{'1M':0.8,'3M':2.4,'YTD':3.2,'1Y':8.4,'3Y_ann':4.2,'5Y_ann':7.8} },
  'UYR':  { exp:'0.95%',  issuer:'ProShares',                     bench:'Dow Jones US Real Estate Ã— 2', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.84%', numH:30,
            desc:'ë¯¸êµ­ ë¶€ë™ì‚°(REITs) ì§€ìˆ˜ì˜ ì¼ì¼ ìˆ˜ìµë¥  Ã—2ë°°ë¥¼ ì¶”ì¢…í•˜ëŠ” ë ˆë²„ë¦¬ì§€ ETF.',
            holdings:[['PLD','Prologis (ë ˆë²„ë¦¬ì§€)',5.91],['AMT','American Tower (ë ˆë²„ë¦¬ì§€)',4.83],['EQIX','Equinix (ë ˆë²„ë¦¬ì§€)',4.12]],
            perf:{'1M':2.8,'3M':7.6,'YTD':8.4,'1Y':22.1,'3Y_ann':3.2,'5Y_ann':9.8} },
  'IWF':  { exp:'0.19%',  issuer:'BlackRock (iShares)',           bench:'Russell 1000 Growth',  structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'0.52%', numH:415,
            desc:'Russell 1000 ì„±ì¥ì£¼ ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF. ê¸°ìˆ Â·í—¬ìŠ¤ì¼€ì–´Â·ì†Œë¹„ì¬ ëŒ€í˜• ì„±ì¥ì£¼ ì¤‘ì‹¬.',
            holdings:[['NVDA','NVIDIA Corp.',12.34],['AAPL','Apple Inc.',12.21],['MSFT','Microsoft Corp.',11.84],['AMZN','Amazon.com',6.42],['META','Meta Platforms',5.81],['GOOGL','Alphabet Class A',4.12],['TSLA','Tesla Inc.',3.84],['AVGO','Broadcom Inc.',3.21],['GOOG','Alphabet Class C',2.95],['LLY','Eli Lilly',2.84]],
            perf:{'1M':3.4,'3M':8.2,'YTD':13.1,'1Y':32.4,'3Y_ann':16.8,'5Y_ann':20.4} },
};

// ì„¹í„° ID â†’ ì´ë¦„ ë§¤í•‘ (ê°„ì†Œí™”)
const SECTOR_NAMES = {
  S01:'ğŸ“ˆ US ëŒ€í˜•ì£¼',S02:'ğŸ’» í…Œí¬ë†€ë¡œì§€',S03:'ğŸ¥ í—¬ìŠ¤ì¼€ì–´',S04:'ğŸ¦ ê¸ˆìœµ',S05:'ğŸ›ï¸ ê²½ê¸°ì†Œë¹„ì¬',
  S06:'ğŸ›’ í•„ìˆ˜ì†Œë¹„ì¬',S07:'ğŸ­ ì‚°ì—…ì¬',S08:'âš¡ ìœ í‹¸ë¦¬í‹°',S09:'ğŸ“¡ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜',S10:'â›ï¸ ì†Œì¬',
  S11:'ğŸŒ êµ­ì œì„ ì§„êµ­',S12:'ğŸŒ ì‹ í¥êµ­',S13:'ğŸ“Š ì¤‘ì†Œí˜•ì£¼',S14:'ğŸ›ï¸ íˆ¬ìë“±ê¸‰ì±„ê¶Œ',S15:'ğŸ’µ ë‹¨ê¸°ì±„/í˜„ê¸ˆì„±',
  S16:'âš ï¸ í•˜ì´ì¼ë“œ',S17:'ğŸ“ˆ TIPS/ì¸í”Œë ˆì´ì…˜',S18:'âœ¨ ê¸ˆ/ê·€ê¸ˆì†',S19:'ğŸ›¢ï¸ ì—ë„ˆì§€/ì›ìì¬',
  S20:'ğŸ˜ï¸ ë¶€ë™ì‚°/REITs',S21:'â‚¿ ê°€ìƒìì‚°',S22:'ğŸ“‰ ì¸ë²„ìŠ¤/ìˆ',S24:'ğŸ§© í…Œë§ˆ/íŠ¹ìˆ˜ëª©ì '
};

// â”€â”€ URLì—ì„œ ticker ì¶”ì¶œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const params = new URLSearchParams(location.search);
const TICKER = (params.get('ticker') || 'SPY').toUpperCase().trim();

document.getElementById('nav-breadcrumb').textContent = '/ ' + TICKER;
document.title = TICKER + ' ETF ìƒì„¸ â€” CORRYU';

// â”€â”€ Watchlist (localStorage) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const watchlist = new Set(JSON.parse(localStorage.getItem('corryu_watchlist') || '[]'));
function toggleWatchlist() {
  if (watchlist.has(TICKER)) watchlist.delete(TICKER);
  else watchlist.add(TICKER);
  localStorage.setItem('corryu_watchlist', JSON.stringify([...watchlist]));
  updateStarBtn();
}
function updateStarBtn() {
  const btn = document.getElementById('star-hero-btn');
  if (!btn) return;
  if (watchlist.has(TICKER)) {
    btn.textContent = 'â˜… ê´€ì‹¬ì¢…ëª©';
    btn.classList.add('starred');
  } else {
    btn.textContent = 'â˜† ê´€ì‹¬ì¢…ëª© ì¶”ê°€';
    btn.classList.remove('starred');
  }
}

// â”€â”€ ê²€ìƒ‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('nav-search-input').addEventListener('keydown', e => {
  if (e.key === 'Enter') goToTicker();
});
function goToTicker() {
  const val = document.getElementById('nav-search-input').value.trim().toUpperCase();
  if (val) location.href = '/etf-detail?ticker=' + encodeURIComponent(val);
}

// â”€â”€ Seeded ì°¨íŠ¸ ìƒì„± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function seededRand(seed) {
  let s = Math.abs(seed) % 2147483647 || 1;
  return () => { s = s * 16807 % 2147483647; return (s - 1) / 2147483646; };
}
function generatePrices(ticker, cagr, vol, n) {
  const seed = [...ticker].reduce((acc, c, i) => acc + c.charCodeAt(0) * (i * 31 + 7), 42);
  const rand = seededRand(seed);
  const mu  = (cagr || 10) / 100 / 252;
  const sig = (vol  || 18) / 100 / Math.sqrt(252);
  let prices = [100];
  for (let i = 1; i < n; i++) {
    // 12-sample CLT approximation of normal distribution
    let z = 0;
    for (let j = 0; j < 12; j++) z += rand();
    z = (z - 6);
    prices.push(prices[i - 1] * Math.exp(mu - 0.5 * sig * sig + sig * z));
  }
  return prices;
}

let currentETF = null;
function generateChartSVG(ticker, cagr, vol, n) {
  const prices = generatePrices(ticker, cagr, vol, n);
  const N = prices.length;
  const W = 700, H = 200;
  const P = { t: 18, r: 10, b: 30, l: 50 };
  const cw = W - P.l - P.r, ch = H - P.t - P.b;

  const minP = Math.min(...prices) * 0.998;
  const maxP = Math.max(...prices) * 1.002;
  const rng  = maxP - minP || 1;
  const toX  = i => P.l + (i / (N - 1)) * cw;
  const toY  = p => P.t + ch - ((p - minP) / rng) * ch;

  const pts = prices.map((p, i) => toX(i).toFixed(1) + ',' + toY(p).toFixed(1));
  const line = 'M ' + pts.join(' L ');
  const area = line + ' L ' + toX(N-1).toFixed(1) + ',' + (P.t+ch) + ' L ' + P.l + ',' + (P.t+ch) + ' Z';
  const isUp = prices[N-1] >= prices[0];
  const col  = isUp ? '#4ade80' : '#f87171';
  const pct  = ((prices[N-1] / prices[0] - 1) * 100).toFixed(1);

  const gridY = [0, 0.25, 0.5, 0.75, 1.0].map(f => {
    const yv  = (P.t + ch - f * ch).toFixed(1);
    const pv  = ((minP + f * rng) / prices[0] - 1) * 100;
    const lbl = (pv > 0 ? '+' : '') + pv.toFixed(0) + '%';
    return `<line x1="${P.l}" y1="${yv}" x2="${P.l+cw}" y2="${yv}" stroke="rgba(255,255,255,0.04)" stroke-width="1"/>
    <text x="${P.l-6}" y="${(+yv+3.5).toFixed(1)}" text-anchor="end" font-size="10" fill="rgba(100,116,139,0.7)" font-family="monospace">${lbl}</text>`;
  }).join('');

  const xPts = n <= 22 ? ['4ì£¼ ì „','3ì£¼ ì „','2ì£¼ ì „','1ì£¼ ì „','í˜„ì¬']
             : n <= 65 ? ['3ê°œì›” ì „','2ê°œì›” ì „','1ê°œì›” ì „','í˜„ì¬','']
             : n <= 130? ['6ê°œì›” ì „','4ê°œì›” ì „','2ê°œì›” ì „','í˜„ì¬','']
             :           ['1ë…„ ì „','9ê°œì›” ì „','6ê°œì›” ì „','3ê°œì›” ì „','í˜„ì¬'];
  const gridX = xPts.map((lbl, i) => {
    const xv = (P.l + (i / (xPts.length - 1)) * cw).toFixed(1);
    return `<text x="${xv}" y="${H-5}" text-anchor="middle" font-size="10" fill="rgba(100,116,139,0.6)" font-family="Inter,sans-serif">${lbl}</text>`;
  }).join('');

  return {
    svg: `<svg viewBox="0 0 ${W} ${H}" width="100%" height="100%" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
  <defs><linearGradient id="ag" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="${col}" stop-opacity="0.18"/><stop offset="100%" stop-color="${col}" stop-opacity="0"/></linearGradient></defs>
  ${gridY}${gridX}
  <path d="${area}" fill="url(#ag)"/>
  <path d="${line}" stroke="${col}" stroke-width="1.8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  <circle cx="${P.l}" cy="${toY(prices[0]).toFixed(1)}" r="3" fill="${col}" opacity="0.5"/>
  <circle cx="${(P.l+cw).toFixed(1)}" cy="${toY(prices[N-1]).toFixed(1)}" r="4" fill="${col}"/>
</svg>`, pct, isUp
  };
}

const PERIOD_DAYS = { '1M': 22, '3M': 65, '6M': 130, '1Y': 252 };
const PERIOD_LABEL = { '1M': '1ê°œì›” ìˆ˜ìµë¥  (ì‹œë®¬ë ˆì´ì…˜)', '3M': '3ê°œì›” ìˆ˜ìµë¥  (ì‹œë®¬ë ˆì´ì…˜)', '6M': '6ê°œì›” ìˆ˜ìµë¥  (ì‹œë®¬ë ˆì´ì…˜)', '1Y': '1ë…„ ìˆ˜ìµë¥  (ì‹œë®¬ë ˆì´ì…˜)' };

function switchPeriod(period, el) {
  if (!currentETF) return;
  document.querySelectorAll('.chart-tab').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  const n = PERIOD_DAYS[period];
  const res = generateChartSVG(currentETF.ticker, currentETF.cagr, currentETF.vol, n);
  document.getElementById('chart-container').innerHTML = res.svg;
  const pctEl = document.getElementById('chart-pct');
  pctEl.textContent = (res.isUp ? '+' : '') + res.pct + '%';
  pctEl.className = 'chart-pct ' + (res.isUp ? 'ret-pos' : 'ret-neg');
  document.getElementById('chart-period-label').textContent = PERIOD_LABEL[period];
}

// â”€â”€ ë Œë”ë§ í•¨ìˆ˜ë“¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function fmtAUM(v) {
  if (!v) return 'â€”';
  const m = v / 1e6;
  return m >= 1000 ? '$' + (m/1000).toFixed(1) + 'B' : '$' + Math.round(m) + 'M';
}
function fmtPct(v, dec=1) {
  if (v === null || v === undefined) return 'â€”';
  return (v > 0 ? '+' : '') + v.toFixed(dec) + '%';
}
function fmtNum(v, dec=2) {
  if (v === null || v === undefined) return 'â€”';
  return v.toFixed(dec);
}
function metricColor(key, val) {
  if (val === null || val === undefined) return 'val-neutral';
  if (key === 'z_score')   return val <= -1.5 ? 'val-neg' : val >= 2.0 ? 'val-pos' : 'val-neutral';
  if (key === 'rsi')       return val <= 30 ? 'val-neg' : val >= 70 ? 'val-pos' : 'val-neutral';
  if (key === 'range_52w') return val <= 20 ? 'val-neg' : val >= 80 ? 'val-pos' : 'val-neutral';
  if (key === 'ma200_pct') return val <= -10 ? 'val-neg' : val >= 15 ? 'val-pos' : 'val-neutral';
  if (key === 'mdd_52w')   return val <= -20 ? 'val-pos' : 'val-neutral';
  if (key === 'cagr')      return val >= 15 ? 'val-good' : val < 0 ? 'val-pos' : 'val-neutral';
  if (key === 'sortino')   return val >= 1.2 ? 'val-purple' : val < 0 ? 'val-pos' : 'val-neutral';
  if (key === 'r_anchor')  return Math.abs(val) >= 0.7 ? 'val-pos' : 'val-neutral';
  return 'val-neutral';
}

function renderGauge(val, min, max, color) {
  const pct = Math.max(0, Math.min(100, ((val - min) / (max - min)) * 100));
  return `<div class="gauge-wrap"><div class="gauge-bar"><div class="gauge-fill" style="width:${pct.toFixed(1)}%;background:${color}"></div></div></div>`;
}

function renderPage(etf, sectorId) {
  currentETF = etf;
  const supp = SUPP[etf.ticker] || {};
  const sector = SECTOR_NAMES[sectorId] || sectorId || 'â€”';

  // â”€â”€ Hero â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  document.getElementById('h-ticker').textContent = etf.ticker;
  document.getElementById('h-ticker').style.color = '#e2e8f0';
  document.getElementById('h-name').textContent   = etf.name;
  document.getElementById('h-aum').textContent     = fmtAUM(etf.aum);
  document.getElementById('h-desc').textContent    = supp.desc || 'â€” í•´ë‹¹ ETFì˜ ìƒì„¸ ì„¤ëª…ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.';
  document.getElementById('h-datadate').textContent = '2026-02-26';
  document.getElementById('note-datadate').textContent = '2026-02-26';

  const badgesHtml =
    `<span class="badge badge-sector">${sector}</span>` +
    (etf.is_legacy ? '<span class="badge badge-legacy">Legacy</span>' : '<span class="badge badge-active">Active</span>') +
    (etf.short_history ? '<span class="badge badge-short">ì§§ì€ì—°í˜ (&lt;3Y)</span>' : '');
  document.getElementById('h-badges').innerHTML = badgesHtml;
  updateStarBtn();

  // â”€â”€ Quick Stats â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  document.getElementById('qs-exp').textContent      = supp.exp      || 'ë°ì´í„° ì¤€ë¹„ ì¤‘';
  document.getElementById('qs-inception').textContent = (etf.inception && etf.inception !== '1900-01-01') ? etf.inception : 'â€”';
  document.getElementById('qs-issuer').textContent   = supp.issuer   || 'ë°ì´í„° ì¤€ë¹„ ì¤‘';
  document.getElementById('qs-bench').textContent    = supp.bench    || 'ë°ì´í„° ì¤€ë¹„ ì¤‘';
  document.getElementById('qs-numh').textContent     = supp.numH !== undefined ? supp.numH.toLocaleString() + 'ê°œ' : 'â€”';

  // â”€â”€ ì°¨íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const res1Y = generateChartSVG(etf.ticker, etf.cagr, etf.vol, 252);
  document.getElementById('chart-container').innerHTML = res1Y.svg;
  const pctEl = document.getElementById('chart-pct');
  pctEl.textContent = (res1Y.isUp ? '+' : '') + res1Y.pct + '%';
  pctEl.className   = 'chart-pct ' + (res1Y.isUp ? 'ret-pos' : 'ret-neg');
  document.getElementById('chart-cagr').textContent = fmtPct(etf.cagr);
  document.getElementById('chart-vol').textContent  = fmtPct(etf.vol);

  // â”€â”€ ê¸°ê°„ë³„ ìˆ˜ìµë¥  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const perf = supp.perf || {};
  const periods = [
    { key: '1M',     label: '1ê°œì›”',   ann: false },
    { key: '3M',     label: '3ê°œì›”',   ann: false },
    { key: 'YTD',    label: 'YTD (ì—°ì´ˆ ì´í›„)', ann: false },
    { key: '1Y',     label: '1ë…„',     ann: false },
    { key: '3Y_ann', label: '3ë…„ (ì—°í™˜ì‚°)',     ann: true },
    { key: '5Y_ann', label: '5ë…„ (ì—°í™˜ì‚°)',     ann: true },
  ];
  const perfRows = periods.map(p => {
    const v = perf[p.key];
    const cls = v === undefined ? 'ret-na' : v >= 0 ? 'ret-pos' : 'ret-neg';
    const disp = v === undefined ? 'â€”' : fmtPct(v);
    const annLabel = p.ann ? 'ì—°í™˜ì‚°' : 'ëˆ„ì ';
    return `<tr>
      <td class="perf-period">${p.label}</td>
      <td class="${cls}">${disp}</td>
      <td style="color:var(--text-muted);font-size:0.75rem">${annLabel}</td>
      <td style="color:var(--text-muted);font-size:0.73rem">${v !== undefined ? 'ì˜ˆì‹œ' : 'â€”'}</td>
    </tr>`;
  }).join('');
  document.getElementById('perf-table-body').innerHTML = perfRows;

  // â”€â”€ ìƒìœ„ êµ¬ì„±ì¢…ëª© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const holdings = supp.holdings;
  let holdHtml = '';
  if (!holdings || holdings.length === 0) {
    holdHtml = '<div style="text-align:center;padding:24px;color:var(--text-muted);font-size:0.85rem">êµ¬ì„±ì¢…ëª© ë°ì´í„° ì¤€ë¹„ ì¤‘</div>';
  } else {
    const maxW = Math.max(...holdings.map(h => h[2]));
    holdHtml = holdings.map(([tk, nm, wt], i) =>
      `<div class="holding-row">
        <span class="holding-rank">${i+1}</span>
        <span class="holding-ticker">${tk}</span>
        <span class="holding-name">${nm}</span>
        <div class="holding-bar-wrap">
          <div class="holding-bar-bg"><div class="holding-bar" style="width:${(wt/maxW*100).toFixed(1)}%"></div></div>
        </div>
        <span class="holding-weight">${wt.toFixed(2)}%</span>
      </div>`
    ).join('');
    const top10Sum = holdings.reduce((s, h) => s + h[2], 0);
    holdHtml += `<div class="holdings-footer">
      <span>ìƒìœ„ 10ê°œ í•©ê³„: <strong style="color:#94a3b8">${top10Sum.toFixed(1)}%</strong></span>
      <span>ì´ ${(supp.numH || '?').toLocaleString()}ê°œ ì¢…ëª© Â· ì˜ˆì‹œ ë°ì´í„°</span>
    </div>`;
  }
  document.getElementById('holdings-container').innerHTML = holdHtml;

  // â”€â”€ ë¶„ì„ ì§€í‘œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const metrics = [
    { label: 'Z-Score', key: 'z_score',   val: etf.short_history ? null : etf.z_score,   fmt: v => fmtNum(v, 2),   gauge: [v => renderGauge(v, -3, 3, '#3b82f6')] },
    { label: 'RSI (14ì¼)', key: 'rsi',     val: etf.rsi,           fmt: v => fmtNum(v, 0) + '  ', gauge: [v => renderGauge(v, 0, 100, '#f59e0b')] },
    { label: '52W Range', key: 'range_52w', val: etf.range_52w,    fmt: v => fmtNum(v, 0) + '%',  gauge: [v => renderGauge(v, 0, 100, '#8b5cf6')] },
    { label: '200MA ì´ê²©', key: 'ma200_pct', val: etf.short_history ? null : etf.ma200_pct, fmt: v => fmtPct(v), gauge: [] },
    { label: '52W MDD',   key: 'mdd_52w',  val: etf.short_history ? null : etf.mdd_52w,  fmt: v => fmtPct(v), gauge: [] },
    { label: 'r_Anchor',  key: 'r_anchor', val: etf.r_anchor,      fmt: v => fmtNum(v, 2), gauge: [] },
    { label: 'SMH Corr',  key: 'smh_corr', val: etf.smh_corr,      fmt: v => v !== null && v !== undefined ? fmtNum(v, 2) : 'â€”', gauge: [] },
    { label: 'CAGR',      key: 'cagr',     val: etf.short_history ? null : etf.cagr,     fmt: v => fmtPct(v), gauge: [] },
    { label: 'ì—°í™˜ì‚° ë³€ë™ì„±', key: 'vol',  val: etf.short_history ? null : etf.vol,      fmt: v => fmtPct(v, 1), gauge: [] },
    { label: 'Sortino',   key: 'sortino',  val: etf.short_history ? null : etf.sortino,  fmt: v => fmtNum(v, 2), gauge: [] },
  ];
  const metricsHtml = metrics.map(m => {
    const display = m.val === null || m.val === undefined ? 'â€”' : m.fmt(m.val);
    const cls     = m.val !== null && m.val !== undefined ? metricColor(m.key, m.val) : 'val-neutral';
    return `<div class="metric-row">
      <span class="metric-label">${m.label}</span>
      <span class="metric-value ${cls}">${display}</span>
    </div>`;
  }).join('');
  document.getElementById('metrics-container').innerHTML = metricsHtml;

  // â”€â”€ í€ë“œ ì •ë³´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const infoRows = [
    { label: 'Rank',      val: etf.rank === 9999 ? 'â€”' : ('#' + etf.rank) },
    { label: 'AUM',       val: fmtAUM(etf.aum) },
    { label: 'ìˆ˜ìˆ˜ë£Œ',    val: supp.exp      || 'â€”' },
    { label: 'ë°œí–‰ì‚¬',    val: supp.issuer   || 'â€”' },
    { label: 'êµ¬ì¡°',      val: supp.structure || 'â€”' },
    { label: 'ë°°ë‹¹ ë°©ì‹', val: supp.div      || 'â€”' },
    { label: 'ë°°ë‹¹ ìˆ˜ìµë¥ ',val: supp.divYield || 'â€”' },
    { label: 'ë²¤ì¹˜ë§ˆí¬',  val: supp.bench    || 'â€”' },
    { label: 'ìƒì¥ì¼',    val: (etf.inception && etf.inception !== '1900-01-01') ? etf.inception : 'â€”' },
    { label: 'ì„¹í„°',      val: sector },
    { label: 'Status',    val: etf.is_legacy ? (etf._user_override ? 'User Legacy' : 'Legacy') : 'Active' },
  ];
  const infoHtml = infoRows.map(r =>
    `<div class="info-row"><span class="info-label">${r.label}</span><span class="info-value">${r.val}</span></div>`
  ).join('');
  document.getElementById('fund-info-container').innerHTML = infoHtml;

  // â”€â”€ ë¹„êµí•˜ê¸° ë²„íŠ¼ URL ì„¸íŒ… â”€â”€
  const compareLink = document.getElementById('compare-hero-link');
  if (compareLink) compareLink.href = '/compare?tickers=' + encodeURIComponent(etf.ticker);

  // â”€â”€ ì§€í‘œ ì´ë ¥ íŠ¸ë Œë“œ ì´ˆê¸°í™” â”€â”€
  // short_history ETFëŠ” Z-Score íƒ­ ë¹„í™œì„±í™”í•˜ê³  RSIë¡œ ê¸°ë³¸ ì„¤ì •
  if (etf.short_history) {
    currentMetricType = 'rsi';
    document.querySelectorAll('#metric-tabs .chart-tab').forEach((t, i) => {
      t.classList.remove('active');
      if (i === 0) { t.style.opacity = '0.3'; t.style.pointerEvents = 'none'; t.title = 'ì§§ì€ì—°í˜ ETF â€” Z-Score ì—†ìŒ'; }
      if (i === 1) t.classList.add('active');
    });
  }
  renderMetricChart(etf);

  // í˜ì´ì§€ í‘œì‹œ
  document.getElementById('loading-state').style.display = 'none';
  document.getElementById('page-content').style.display = 'block';
}

// â”€â”€ ì§€í‘œ ì´ë ¥ íŠ¸ë Œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const METRIC_CONFIG = {
  zscore:  { label: 'Z-Score',   unit: '',  min: -3,  max: 3,   refs: [-2, -1.5, 0, 1.5, 2],   refColor: { '-2': '#60a5fa', '-1.5': '#93c5fd', '0': '#475569', '1.5': '#fca5a5', '2': '#f87171' }, color: v => v > 1.5 ? '#f87171' : v < -1.5 ? '#60a5fa' : '#94a3b8' },
  rsi:     { label: 'RSI (14ì¼)', unit: '',  min: 0,   max: 100, refs: [30, 50, 70],            refColor: { '30': '#60a5fa', '50': '#475569', '70': '#f87171' },                                  color: v => v > 70 ? '#f87171' : v < 30 ? '#60a5fa' : '#94a3b8' },
  range52w:{ label: '52W Range', unit: '%', min: 0,   max: 100, refs: [20, 50, 80],            refColor: { '20': '#60a5fa', '50': '#475569', '80': '#4ade80' },                                  color: v => v > 80 ? '#4ade80' : v < 20 ? '#60a5fa' : '#94a3b8' },
  mdd:     { label: '52W MDD',   unit: '%', min: -50, max: 0,   refs: [-30, -20, -10],         refColor: { '-30': '#f87171', '-20': '#fca5a5', '-10': '#fcd34d' },                               color: v => v < -20 ? '#f87171' : v < -10 ? '#fbbf24' : '#94a3b8' },
};

let currentMetricType = 'zscore';
let currentETFForMetric = null;

function genMetricSeries(ticker, metricType, n = 252) {
  const baseSeed = [...ticker].reduce((a,c,i) => a + c.charCodeAt(0)*(i*13+5), 77);
  const offsets  = { zscore: 1000, rsi: 2000, range52w: 3000, mdd: 4000 };
  const rand = seededRand(baseSeed + offsets[metricType]);

  if (metricType === 'zscore') {
    let z = (rand() - 0.5) * 3;
    const s = [z];
    for (let i = 1; i < n; i++) {
      let noise = 0; for (let j = 0; j < 6; j++) noise += rand() - 0.5;
      z = z * 0.96 + noise * 0.22;
      z = Math.max(-3, Math.min(3, z));
      s.push(z);
    }
    return s;
  }
  if (metricType === 'rsi') {
    let v = 30 + rand() * 40;
    const s = [v];
    for (let i = 1; i < n; i++) {
      let noise = 0; for (let j = 0; j < 4; j++) noise += rand() - 0.5;
      v = v * 0.91 + 50 * 0.09 + noise * 6;
      v = Math.max(10, Math.min(90, v));
      s.push(v);
    }
    return s;
  }
  if (metricType === 'range52w') {
    let v = 20 + rand() * 60;
    const s = [v];
    for (let i = 1; i < n; i++) {
      let noise = 0; for (let j = 0; j < 4; j++) noise += rand() - 0.5;
      v = v * 0.97 + 50 * 0.03 + noise * 4;
      v = Math.max(0, Math.min(100, v));
      s.push(v);
    }
    return s;
  }
  if (metricType === 'mdd') {
    let v = -5 - rand() * 15;
    const s = [v];
    for (let i = 1; i < n; i++) {
      let noise = 0; for (let j = 0; j < 4; j++) noise += rand() - 0.5;
      v = v * 0.96 + (-10) * 0.04 + noise * 1.8;
      v = Math.min(0, Math.max(-50, v));
      s.push(v);
    }
    return s;
  }
  return [];
}

function generateMetricChartSVG(series, metricType, currentVal) {
  const cfg = METRIC_CONFIG[metricType];
  const N = series.length;
  const W = 700, H = 200;
  const P = { t: 18, r: 10, b: 30, l: 50 };
  const cw = W - P.l - P.r, ch = H - P.t - P.b;
  const rng = cfg.max - cfg.min;
  const toX = i => P.l + (i / (N - 1)) * cw;
  const toY = v => P.t + ch - ((v - cfg.min) / rng) * ch;

  // Reference lines
  const refLines = cfg.refs.map(r => {
    const yv = toY(r).toFixed(1);
    const refCol = cfg.refColor[String(r)] || 'rgba(255,255,255,0.08)';
    const lbl = r + cfg.unit;
    return `<line x1="${P.l}" y1="${yv}" x2="${P.l + cw}" y2="${yv}" stroke="${refCol}" stroke-opacity="0.3" stroke-width="1" stroke-dasharray="3,3"/>
    <text x="${P.l - 5}" y="${(+yv + 3.5).toFixed(1)}" text-anchor="end" font-size="10" fill="rgba(100,116,139,0.7)" font-family="monospace">${lbl}</text>`;
  }).join('');

  // Fill area under the line (subtle)
  const pts = series.map((v, i) => toX(i).toFixed(1) + ',' + toY(v).toFixed(1));
  const linePath = 'M ' + pts.join(' L ');
  const lineColor = currentVal !== null && currentVal !== undefined ? cfg.color(currentVal) : '#94a3b8';

  // X labels
  const xLabels = ['1ë…„ ì „', '9ê°œì›” ì „', '6ê°œì›” ì „', '3ê°œì›” ì „', 'í˜„ì¬'].map((l, i) =>
    `<text x="${(P.l + (i / 4) * cw).toFixed(1)}" y="${H - 5}" text-anchor="middle" font-size="10" fill="rgba(100,116,139,0.6)" font-family="Inter,sans-serif">${l}</text>`
  ).join('');

  const lastX = toX(N - 1).toFixed(1);
  const lastY = toY(series[N - 1]).toFixed(1);

  return `<svg viewBox="0 0 ${W} ${H}" width="100%" height="100%" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
  ${refLines}${xLabels}
  <path d="${linePath}" stroke="${lineColor}" stroke-width="1.8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  <circle cx="${lastX}" cy="${lastY}" r="4" fill="${lineColor}"/>
</svg>`;
}

function switchMetric(type, el) {
  document.querySelectorAll('#metric-tabs .chart-tab').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  currentMetricType = type;
  if (currentETFForMetric) renderMetricChart(currentETFForMetric);
}

function renderMetricChart(etf) {
  currentETFForMetric = etf;
  const cfg = METRIC_CONFIG[currentMetricType];
  const series = genMetricSeries(etf.ticker, currentMetricType);

  // Current value from actual ETF data
  const valMap = { zscore: etf.z_score, rsi: etf.rsi, range52w: etf.range_52w, mdd: etf.mdd_52w };
  const currentVal = etf.short_history && currentMetricType === 'zscore' ? null : (valMap[currentMetricType] ?? null);

  // Update UI
  const label = document.getElementById('metric-current-label');
  const valEl = document.getElementById('metric-current-val');
  label.textContent = 'í˜„ì¬ ' + cfg.label;

  if (currentVal !== null && currentVal !== undefined) {
    const formatted = currentMetricType === 'zscore' || currentMetricType === 'rsi'
      ? currentVal.toFixed(currentMetricType === 'rsi' ? 0 : 2)
      : currentVal.toFixed(1) + cfg.unit;
    valEl.textContent = formatted;
    valEl.style.color = cfg.color(currentVal);
  } else {
    valEl.textContent = 'â€” (ë°ì´í„° ì—†ìŒ)';
    valEl.style.color = '#334155';
  }

  // Reference legend
  const legend = document.getElementById('metric-ref-legend');
  legend.innerHTML = cfg.refs.map(r => {
    const c = cfg.refColor[String(r)] || '#475569';
    return `<span class="metric-ref-dot"><span style="display:inline-block;width:20px;height:2px;background:${c};opacity:0.6;border-radius:1px"></span>${r}${cfg.unit}</span>`;
  }).join('');

  // Chart
  document.getElementById('metric-chart-container').innerHTML = generateMetricChartSVG(series, currentMetricType, currentVal);
}

// â”€â”€ ë°ì´í„° ë¡œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
fetch('/etf_data.json')
  .then(r => { if (!r.ok) throw new Error('fetch failed'); return r.json(); })
  .then(data => {
    let found = null, foundSid = null;
    for (const [sid, etfs] of Object.entries(data)) {
      const e = etfs.find(x => x.ticker === TICKER);
      if (e) { found = e; foundSid = sid; break; }
    }
    if (!found) {
      document.getElementById('loading-state').style.display = 'none';
      document.getElementById('error-title').textContent = '"' + TICKER + '" ETFë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤';
      document.getElementById('error-msg').textContent   = 'í‹°ì»¤ ì‹¬ë³¼ì„ í™•ì¸í•˜ê±°ë‚˜ ìœ„ ê²€ìƒ‰ì°½ì—ì„œ ë‹¤ì‹œ ê²€ìƒ‰í•´ì£¼ì„¸ìš”.';
      document.getElementById('error-state').style.display = 'flex';
      return;
    }
    // localStorage ì˜¤ë²„ë¼ì´ë“œ ë°˜ì˜ (ì½ê¸° ì „ìš©)
    const ov = JSON.parse(localStorage.getItem('corryu_user_overrides') || '{}');
    if (ov[TICKER]) {
      if ('is_legacy' in ov[TICKER]) found.is_legacy = ov[TICKER].is_legacy;
      if (ov[TICKER].is_legacy) found._user_override = true;
    }
    renderPage(found, foundSid);
    I18n.init();
  })
  .catch(() => {
    document.getElementById('loading-state').style.display = 'none';
    document.getElementById('error-title').textContent = 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤';
    document.getElementById('error-msg').textContent   = 'ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ í™•ì¸í•˜ê±°ë‚˜ ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
    document.getElementById('error-state').style.display = 'flex';
  });
</script>
</body>
</html>
