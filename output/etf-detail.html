<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ETF ìƒì„¸ â€” CORRYU</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<script src="/supabase-client.js"></script>
<script src="/i18n.js"></script>
<script src="https://unpkg.com/lightweight-charts@4.1.3/dist/lightweight-charts.standalone.production.js"></script>
<style>
/* â”€â”€ ëŒ“ê¸€ ê³µí†µ ìŠ¤íƒ€ì¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.c-sort-btn{padding:4px 10px;border-radius:6px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);color:#64748b;font-size:.72rem;font-weight:700;cursor:pointer;font-family:inherit;transition:all .15s}
.c-sort-btn.c-sort-on{background:rgba(59,130,246,0.14);border-color:rgba(59,130,246,0.35);color:#60a5fa}
.c-item{padding:14px 0;border-bottom:1px solid rgba(255,255,255,0.04)}
.c-item:last-child{border-bottom:none}
.c-reply-item{padding:10px 0 0 0;margin-left:44px}
.c-avatar{width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:.82rem;flex-shrink:0}
.c-nick{font-size:.84rem;font-weight:800;color:#e2e8f0}
.c-time{font-size:.72rem;color:#475569}
.c-body{font-size:.85rem;color:#cbd5e1;line-height:1.65;margin:6px 0 8px;white-space:pre-wrap;word-break:break-word}
.c-action-row{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.c-vote-btn{display:inline-flex;align-items:center;gap:4px;background:none;border:none;color:#475569;font-size:.78rem;font-weight:700;cursor:pointer;padding:3px 7px;border-radius:5px;font-family:inherit;transition:all .15s}
.c-vote-btn:hover{background:rgba(255,255,255,0.05);color:#94a3b8}
.c-vote-btn.voted-like{color:#4ade80}
.c-vote-btn.voted-dislike{color:#f87171}
.c-reply-toggle{background:none;border:none;color:#475569;font-size:.75rem;font-weight:700;cursor:pointer;padding:3px 7px;border-radius:5px;font-family:inherit;transition:all .15s}
.c-reply-toggle:hover{background:rgba(255,255,255,0.05);color:#94a3b8}
.c-reply-count{font-size:.72rem;color:#334155}
.c-del-btn{background:none;border:none;color:#334155;font-size:.7rem;cursor:pointer;padding:2px 6px;border-radius:4px;font-family:inherit;transition:color .15s;margin-left:auto}
.c-del-btn:hover{color:#f87171}
.c-reply-form{margin-top:10px;margin-left:44px;display:flex;gap:8px;align-items:flex-start}
.c-reply-textarea{flex:1;min-height:56px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:8px;color:#e2e8f0;font-size:.82rem;font-family:inherit;padding:8px 10px;outline:none;resize:vertical;transition:border .15s;line-height:1.5}
.c-reply-textarea:focus{border-color:rgba(59,130,246,0.4)}
.c-reply-submit{padding:5px 12px;border-radius:7px;background:#3b82f6;border:none;color:#fff;font-size:.76rem;font-weight:700;cursor:pointer;font-family:inherit;white-space:nowrap}
.c-reply-cancel{padding:5px 10px;border-radius:7px;background:none;border:1px solid rgba(255,255,255,0.08);color:#64748b;font-size:.76rem;font-weight:700;cursor:pointer;font-family:inherit}
.c-replies-list{margin-top:8px;padding-left:44px;border-left:2px solid rgba(255,255,255,0.06)}
.c-reply-item-inner{padding:10px 0;border-bottom:1px solid rgba(255,255,255,0.03)}
.c-reply-item-inner:last-child{border-bottom:none}
:root {
  --bg-primary: #0a0d14;
  --bg-card:    rgba(18,22,36,0.92);
  --border:     rgba(255,255,255,0.07);
  --text-primary: #e2e8f0;
  --text-muted:   #64748b;
  --accent:     #3b82f6;
  --accent-glow: rgba(59,130,246,0.25);
}
* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  background: var(--bg-primary);
  color: var(--text-primary);
  font-family: 'Inter', -apple-system, sans-serif;
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}

/* â”€â”€ ê³µí†µ ìœ í‹¸ â”€â”€ */
.glass {
  background: var(--bg-card);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border: 1px solid var(--border);
  border-radius: 14px;
}
.text-gradient {
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text;
}
.gradient-line {
  position: fixed; top: 0; left: 0; right: 0; height: 3px; z-index: 200;
  background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899, #f59e0b);
}

/* â”€â”€ Navbar â”€â”€ */
nav {
  position: fixed; top: 3px; left: 0; right: 0; z-index: 100;
  background: rgba(10,13,20,0.9); backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border); height: 56px;
  display: flex; align-items: center;
}
.nav-inner {
  max-width: 1320px; margin: 0 auto; padding: 0 24px;
  width: 100%; display: flex; align-items: center; gap: 14px;
}
.nav-back {
  display: flex; align-items: center; gap: 6px;
  color: var(--text-muted); font-size: 0.82rem; font-weight: 600;
  text-decoration: none; transition: color 0.15s; white-space: nowrap;
}
.nav-back:hover { color: #60a5fa; }
.nav-sep { color: #1e293b; }
.nav-brand {
  font-size: 0.95rem; font-weight: 900; text-decoration: none; white-space: nowrap;
}
.nav-search {
  flex: 1; max-width: 320px; margin-left: auto;
  display: flex; align-items: center; gap: 0;
  background: rgba(255,255,255,0.04); border: 1px solid var(--border);
  border-radius: 8px; overflow: hidden;
}
.nav-search input {
  flex: 1; background: none; border: none; outline: none;
  color: var(--text-primary); font-size: 0.82rem; font-family: inherit;
  padding: 7px 10px;
}
.nav-search input::placeholder { color: var(--text-muted); }
.nav-search button {
  background: none; border: none; color: var(--text-muted);
  padding: 7px 10px; cursor: pointer; font-size: 0.85rem;
  transition: color 0.15s;
}
.nav-search button:hover { color: var(--text-primary); }

/* â”€â”€ ë©”ì¸ ë ˆì´ì•„ì›ƒ â”€â”€ */
.main-wrap {
  max-width: 1320px; margin: 0 auto;
  padding: 76px 20px 48px;
}

/* â”€â”€ ë¡œë”© / ì—ëŸ¬ â”€â”€ */
#loading-state, #error-state {
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  min-height: 60vh; gap: 16px; text-align: center;
}
.spinner {
  width: 36px; height: 36px; border: 3px solid rgba(255,255,255,0.1);
  border-top-color: var(--accent); border-radius: 50%;
  animation: spin 0.8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* â”€â”€ Hero ì¹´ë“œ â”€â”€ */
.hero-card {
  padding: 28px 32px;
  margin-bottom: 14px;
  position: relative; overflow: hidden;
}
.hero-card::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
}
.hero-grid {
  display: grid; grid-template-columns: 1fr auto;
  gap: 24px; align-items: flex-start;
}
.hero-ticker {
  font-size: 3rem; font-weight: 900; letter-spacing: -0.04em;
  line-height: 1; margin-bottom: 4px;
}
.hero-name {
  font-size: 0.95rem; color: #94a3b8; margin-bottom: 14px; font-weight: 400;
}
.hero-badges { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 16px; }
.badge {
  display: inline-flex; align-items: center; gap: 4px;
  padding: 3px 10px; border-radius: 6px; font-size: 0.73rem; font-weight: 700;
}
.badge-sector  { background: rgba(59,130,246,0.1); color: #60a5fa; border: 1px solid rgba(59,130,246,0.2); }
.badge-active  { background: rgba(74,222,128,0.1); color: #4ade80; border: 1px solid rgba(74,222,128,0.2); }
.badge-legacy  { background: rgba(248,113,113,0.1); color: #f87171; border: 1px solid rgba(248,113,113,0.2); }
.badge-short   { background: rgba(234,179,8,0.1);   color: #facc15; border: 1px solid rgba(234,179,8,0.2); }
.hero-desc { font-size: 0.84rem; color: var(--text-muted); line-height: 1.7; max-width: 600px; }
.hero-price-box { text-align: right; }
.price-label { font-size: 0.72rem; color: var(--text-muted); margin-bottom: 4px; }
.price-na { font-size: 1rem; color: #334155; font-weight: 600; }
.price-note { font-size: 0.7rem; color: #334155; margin-top: 4px; }
.star-hero-btn {
  background: none; border: 1px solid rgba(255,255,255,0.1); cursor: pointer;
  color: #374151; font-size: 1.2rem; padding: 6px 12px; border-radius: 8px;
  transition: all 0.15s; margin-top: 10px; font-family: inherit;
}
.star-hero-btn.starred { color: #fbbf24; border-color: rgba(251,191,36,0.4); background: rgba(251,191,36,0.08); }
.star-hero-btn:hover { color: #fbbf24; border-color: rgba(251,191,36,0.3); }
.compare-hero-btn {
  display: inline-flex; align-items: center; gap: 5px;
  background: none; border: 1px solid rgba(167,139,250,0.25); cursor: pointer;
  color: #a78bfa; font-size: 0.78rem; font-weight: 700; padding: 6px 12px; border-radius: 8px;
  transition: all 0.15s; text-decoration: none; font-family: inherit; margin-top: 10px;
}
.compare-hero-btn:hover { background: rgba(167,139,250,0.1); border-color: rgba(167,139,250,0.5); }

/* â”€â”€ ì§€í‘œ ì´ë ¥ íŠ¸ë Œë“œ â”€â”€ */
.metric-stat-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.metric-current-val { font-size: 1.4rem; font-weight: 900; letter-spacing: -0.03em; }
.metric-ref-dots { display: flex; gap: 10px; flex-wrap: wrap; }
.metric-ref-dot { display: flex; align-items: center; gap: 4px; font-size: 0.7rem; color: var(--text-muted); }

/* â”€â”€ Quick Stats Bar â”€â”€ */
.quick-stats {
  display: grid; grid-template-columns: repeat(5, 1fr);
  gap: 0; margin-bottom: 20px;
  background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px;
  overflow: hidden;
}
.qs-item {
  padding: 14px 16px; text-align: center;
  border-right: 1px solid var(--border);
}
.qs-item:last-child { border-right: none; }
.qs-label { font-size: 0.68rem; color: var(--text-muted); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 5px; }
.qs-value { font-size: 0.95rem; font-weight: 700; }

/* â”€â”€ ì»¨í…ì¸  ê·¸ë¦¬ë“œ â”€â”€ */
.content-grid {
  display: grid;
  grid-template-columns: 3fr 2fr;
  gap: 16px;
  align-items: start;
}
.card { padding: 22px 24px; margin-bottom: 16px; }
.card-title {
  font-size: 0.78rem; font-weight: 700; letter-spacing: 0.06em;
  text-transform: uppercase; color: var(--text-muted); margin-bottom: 18px;
  display: flex; align-items: center; gap: 8px;
}
.card-title::after { content: ''; flex: 1; height: 1px; background: var(--border); }

/* â”€â”€ ì°¨íŠ¸ â”€â”€ */
.chart-tabs {
  display: flex; gap: 4px; margin-bottom: 14px;
}
.chart-tab {
  padding: 4px 12px; border-radius: 6px; font-size: 0.78rem; font-weight: 700;
  border: none; cursor: pointer; background: rgba(255,255,255,0.04);
  color: var(--text-muted); transition: all 0.15s; font-family: inherit;
}
.chart-tab.active {
  background: rgba(59,130,246,0.15); color: #60a5fa;
  border: 1px solid rgba(59,130,246,0.3);
}
.chart-tab:hover:not(.active) { color: var(--text-primary); background: rgba(255,255,255,0.07); }
.chart-stat {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 10px;
}
.chart-pct {
  font-size: 1.5rem; font-weight: 900; letter-spacing: -0.03em;
}
.chart-period-label { font-size: 0.75rem; color: var(--text-muted); }
.chart-container { width: 100%; height: 300px; overflow: hidden; position: relative; }
.chart-disclaimer {
  font-size: 0.68rem; color: #2d3748; margin-top: 6px; text-align: right;
}
.chart-toolbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
.chart-type-btn {
  padding: 4px 12px; border-radius: 6px; font-size: 0.78rem; font-weight: 700;
  border: 1px solid transparent; cursor: pointer; background: rgba(255,255,255,0.04);
  color: var(--text-muted); transition: all 0.15s; font-family: inherit;
}
.chart-type-btn.active { background: rgba(59,130,246,0.15); color: #60a5fa; border-color: rgba(59,130,246,0.3); }
.chart-type-btn:hover:not(.active) { color: var(--text-primary); background: rgba(255,255,255,0.07); }
#price-tooltip {
  position: absolute; display: none; pointer-events: none; z-index: 10;
  background: rgba(10,18,35,0.93); border: 1px solid rgba(255,255,255,0.12);
  border-radius: 8px; padding: 8px 12px; font-size: 0.78rem; color: #e2e8f0;
  font-family: 'Inter', monospace; line-height: 1.8; white-space: nowrap;
  box-shadow: 0 4px 20px rgba(0,0,0,0.5);
}
/* â”€â”€ ì§€í‘œ ì„¤ì • íŒ¨ë„ â”€â”€ */
.ind-settings-btn {
  padding: 3px 9px; border-radius: 5px; font-size: 0.73rem; font-weight: 700;
  border: 1px solid rgba(255,255,255,0.1); cursor: pointer;
  background: rgba(255,255,255,0.04); color: var(--text-muted);
  transition: all 0.15s; font-family: inherit;
}
.ind-settings-btn.active, .ind-settings-btn:hover {
  background: rgba(59,130,246,0.15); color: #60a5fa; border-color: rgba(59,130,246,0.3);
}
.ind-panel {
  display: none; margin-bottom: 12px; padding: 10px 14px;
  background: rgba(255,255,255,0.025); border: 1px solid rgba(255,255,255,0.07);
  border-radius: 8px;
}
.ind-panel.open { display: block; }
.ind-panel-section { margin-bottom: 9px; }
.ind-panel-label {
  font-size: 0.65rem; font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.07em; color: #475569; margin-bottom: 7px;
}
.ind-grid { display: flex; flex-wrap: wrap; gap: 3px 14px; }
.ind-item {
  display: flex; align-items: center; gap: 5px;
  font-size: 0.78rem; color: var(--text-muted);
  cursor: pointer; user-select: none; padding: 3px 0;
}
.ind-item input[type=checkbox] { display: none; }
.ind-item:has(input:checked) { color: var(--text-primary); }
.ind-swatch { width: 12px; height: 3px; border-radius: 2px; opacity: 0.4; flex-shrink: 0; transition: opacity 0.15s; }
.ind-item:has(input:checked) .ind-swatch { opacity: 1; }
/* Sub-charts */
.sub-chart-wrap { position: relative; border-top: 1px solid rgba(255,255,255,0.05); padding-top: 2px; margin-top: 2px; }
.sub-chart-label {
  position: absolute; top: 5px; left: 6px; font-size: 0.62rem; font-weight: 700;
  color: #475569; pointer-events: none; z-index: 5;
  text-transform: uppercase; letter-spacing: 0.05em;
}

/* â”€â”€ ì„±ê³¼ í…Œì´ë¸” â”€â”€ */
.perf-table { width: 100%; border-collapse: collapse; }
.perf-table th {
  font-size: 0.72rem; color: var(--text-muted); font-weight: 600;
  text-align: left; padding: 6px 0; border-bottom: 1px solid var(--border);
}
.perf-table th:not(:first-child) { text-align: right; }
.perf-table td {
  font-size: 0.85rem; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.03);
}
.perf-table td:not(:first-child) { text-align: right; font-weight: 600; font-variant-numeric: tabular-nums; }
.perf-table tr:last-child td { border-bottom: none; }
.perf-period { color: var(--text-muted); font-size: 0.8rem; }
.ret-pos { color: #4ade80; }
.ret-neg { color: #f87171; }
.ret-na  { color: #334155; }

/* â”€â”€ êµ¬ì„±ì¢…ëª© â”€â”€ */
.holding-row { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
.holding-rank { font-size: 0.68rem; color: #334155; width: 16px; text-align: right; flex-shrink: 0; }
.holding-ticker { font-size: 0.8rem; font-weight: 700; color: #60a5fa; width: 60px; flex-shrink: 0; }
.holding-name { font-size: 0.78rem; color: var(--text-muted); flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.holding-weight { font-size: 0.8rem; font-weight: 700; width: 50px; text-align: right; flex-shrink: 0; }
.holding-bar-wrap { width: 100px; flex-shrink: 0; }
.holding-bar-bg { height: 4px; background: rgba(255,255,255,0.05); border-radius: 2px; overflow: hidden; }
.holding-bar { height: 100%; background: linear-gradient(90deg, #3b82f6, #8b5cf6); border-radius: 2px; }
.holdings-footer {
  margin-top: 14px; padding-top: 12px; border-top: 1px solid var(--border);
  font-size: 0.75rem; color: var(--text-muted); display: flex; justify-content: space-between;
}

/* â”€â”€ ë¶„ì„ ì§€í‘œ â”€â”€ */
.metric-row {
  display: flex; justify-content: space-between; align-items: center;
  padding: 9px 0; border-bottom: 1px solid rgba(255,255,255,0.04);
}
.metric-row:last-child { border-bottom: none; }
.metric-label { font-size: 0.8rem; color: var(--text-muted); }
.metric-value { font-size: 0.88rem; font-weight: 700; font-variant-numeric: tabular-nums; }
.val-pos { color: #f87171; }   /* ê³¼ë§¤ìˆ˜/ë†’ìŒ */
.val-neg { color: #60a5fa; }   /* ê³¼ë§¤ë„/ë‚®ìŒ */
.val-good { color: #4ade80; }  /* ì¢‹ìŒ */
.val-warn { color: #fbbf24; }  /* ì£¼ì˜ */
.val-purple { color: #a78bfa; }
.val-neutral { color: #94a3b8; }

/* ê²Œì´ì§€ ë°” */
.gauge-wrap { display: flex; align-items: center; gap: 6px; }
.gauge-bar { flex: 1; height: 4px; background: rgba(255,255,255,0.06); border-radius: 2px; overflow: hidden; }
.gauge-fill { height: 100%; border-radius: 2px; }

/* â”€â”€ í€ë“œ ì •ë³´ â”€â”€ */
.info-row {
  display: flex; justify-content: space-between; align-items: center;
  padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.04);
  gap: 8px;
}
.info-row:last-child { border-bottom: none; }
.info-label { font-size: 0.78rem; color: var(--text-muted); flex-shrink: 0; }
.info-value { font-size: 0.82rem; font-weight: 600; text-align: right; }

/* â”€â”€ ê¸°ì¤€ì¼ ë…¸íŠ¸ â”€â”€ */
.data-note {
  padding: 14px 18px; border-radius: 10px;
  background: rgba(255,255,255,0.02); border: 1px solid var(--border);
  font-size: 0.75rem; color: var(--text-muted); line-height: 1.7;
}

/* â”€â”€ ë°˜ì‘í˜• â”€â”€ */
@media (max-width: 900px) {
  .content-grid { grid-template-columns: 1fr; }
  .quick-stats { grid-template-columns: repeat(3, 1fr); }
  .quick-stats .qs-item:nth-child(4),
  .quick-stats .qs-item:nth-child(5) { border-top: 1px solid var(--border); }
}
@media (max-width: 600px) {
  .hero-grid { grid-template-columns: 1fr; }
  .hero-ticker { font-size: 2rem; }
  .quick-stats { grid-template-columns: 1fr 1fr; }
  .card { padding: 16px; }
  .hero-card { padding: 20px; }
  .holding-bar-wrap { display: none; }
}
</style>
</head>
<body>

<div class="gradient-line"></div>

<!-- â”€â”€ Navbar â”€â”€ -->
<nav>
  <div class="nav-inner">
    <a href="/index" class="nav-back">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 12H5M12 5l-7 7 7 7"/></svg>
      <span data-i18n="nav.dashboard">ëŒ€ì‹œë³´ë“œ</span>
    </a>
    <span class="nav-sep">/</span>
    <a href="/landing" class="nav-brand"><span class="text-gradient">CORRYU</span></a>
    <span id="nav-breadcrumb" style="font-size:0.82rem;color:var(--text-muted)"></span>
    <div style="display:flex;align-items:center;gap:12px;margin-left:auto">
      <a href="/screener" style="font-size:0.78rem;color:var(--text-muted);text-decoration:none;font-weight:600;display:flex;align-items:center;gap:4px">
        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg><span data-i18n="nav.screener">ìŠ¤í¬ë¦¬ë„ˆ</span>
      </a>
      <a id="nav-backtest-link" href="/backtest" style="font-size:0.78rem;color:var(--text-muted);text-decoration:none;font-weight:600;display:flex;align-items:center;gap:4px">
        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span data-i18n="detail.nav.backtest">ë°±í…ŒìŠ¤íŠ¸</span>
      </a>
      <a href="/correlation" style="font-size:0.78rem;color:var(--text-muted);text-decoration:none;font-weight:600;display:flex;align-items:center;gap:4px">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="8" cy="8" r="2"/><circle cx="16" cy="8" r="2"/><circle cx="12" cy="16" r="2"/><line x1="10" y1="8" x2="14" y2="8"/><line x1="9" y1="10" x2="11" y2="14"/><line x1="15" y1="10" x2="13" y2="14"/></svg><span data-i18n="nav.correlation">ìƒê´€ê´€ê³„</span>
      </a>
      <a href="/compare" style="font-size:0.78rem;color:var(--text-muted);text-decoration:none;font-weight:600;display:flex;align-items:center;gap:4px">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span data-i18n="nav.compare">ë¹„êµ</span>
      </a>
      <a href="/portfolio" style="font-size:0.78rem;color:var(--text-muted);text-decoration:none;font-weight:600;display:flex;align-items:center;gap:4px">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 7V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v2"/></svg><span data-i18n="detail.nav.portfolio">í¬íŠ¸í´ë¦¬ì˜¤</span>
      </a>
    </div>
    <div class="nav-search">
      <input type="text" id="nav-search-input" data-i18n-placeholder="detail.nav.search.placeholder" placeholder="ë‹¤ë¥¸ í‹°ì»¤ ê²€ìƒ‰ (ì˜ˆ: QQQ)" autocomplete="off">
      <button onclick="goToTicker()">â†’</button>
    </div>
  </div>
</nav>

<!-- â”€â”€ ë©”ì¸ â”€â”€ -->
<div class="main-wrap">

  <!-- ë¡œë”© ìƒíƒœ -->
  <div id="loading-state">
    <div class="spinner"></div>
    <p style="color:var(--text-muted);font-size:0.85rem" data-i18n="detail.loading">ETF ë°ì´í„° ë¡œë”© ì¤‘â€¦</p>
  </div>

  <!-- ì—ëŸ¬ ìƒíƒœ -->
  <div id="error-state" style="display:none">
    <div style="font-size:2rem">ğŸ”</div>
    <h2 id="error-title" style="font-size:1.1rem;font-weight:700" data-i18n="detail.not.found">ETFë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h2>
    <p id="error-msg" style="font-size:0.85rem;color:var(--text-muted)"></p>
    <a href="/index" style="margin-top:12px;padding:8px 20px;border-radius:8px;background:var(--accent);color:white;text-decoration:none;font-size:0.85rem;font-weight:700" data-i18n="detail.back">â† ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</a>
  </div>

  <!-- ì‹¤ì œ ì½˜í…ì¸  (JSë¡œ í‘œì‹œ) -->
  <div id="page-content" style="display:none">

    <!-- â”€â”€ Hero â”€â”€ -->
    <div class="glass hero-card" id="hero-card">
      <div class="hero-grid">
        <div>
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:2px">
            <div class="hero-ticker" id="h-ticker">â€”</div>
            <button class="star-hero-btn" id="star-hero-btn" onclick="toggleWatchlist()" title="ê´€ì‹¬ì¢…ëª© ì¶”ê°€/ì œê±°">â˜…</button>
            <a href="#" id="compare-hero-link" class="compare-hero-btn" title="ETF ë¹„êµ í˜ì´ì§€ë¡œ ì´ë™">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span data-i18n="detail.compare.btn">ë¹„êµí•˜ê¸°</span>
            </a>
            <!-- ì¢…ëª© ì¢‹ì•„ìš” ë²„íŠ¼ -->
            <button id="tl-btn" onclick="tickerLikeToggle()" title="ì´ ì¢…ëª© ì¢‹ì•„ìš”"
              style="display:none;align-items:center;gap:5px;padding:4px 11px;border-radius:20px;border:1px solid rgba(244,114,182,0.25);background:rgba(244,114,182,0.07);color:#94a3b8;font-size:.78rem;font-weight:700;cursor:pointer;font-family:inherit;transition:all .15s">
              <svg id="tl-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>
              <span id="tl-count">0</span>
            </button>
          </div>
          <div class="hero-name" id="h-name">â€”</div>
          <div class="hero-badges" id="h-badges"></div>
          <p class="hero-desc" id="h-desc"></p>
        </div>
        <div class="hero-price-box">
          <div class="price-label" data-i18n="detail.price.label">ì‹¤ì‹œê°„ ì‹œì„¸</div>
          <div class="price-na" data-i18n="detail.price.na">â€” ì—°ë™ ì˜ˆì •</div>
          <div style="margin-top:12px;text-align:right">
            <div style="font-size:0.72rem;color:var(--text-muted)">AUM</div>
            <div style="font-size:1.1rem;font-weight:800" id="h-aum">â€”</div>
          </div>
          <div class="price-note"><span data-i18n="detail.datadate">ë°ì´í„° ê¸°ì¤€ì¼:</span> <span id="h-datadate">â€”</span></div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ Quick Stats â”€â”€ -->
    <div class="quick-stats" id="quick-stats">
      <div class="qs-item">
        <div class="qs-label" data-i18n="detail.qs.expense">ìˆ˜ìˆ˜ë£Œ (Expense Ratio)</div>
        <div class="qs-value" id="qs-exp">â€”</div>
      </div>
      <div class="qs-item">
        <div class="qs-label" data-i18n="detail.qs.inception">ìµœì´ˆ ìƒì¥ì¼</div>
        <div class="qs-value" id="qs-inception">â€”</div>
      </div>
      <div class="qs-item">
        <div class="qs-label" data-i18n="detail.qs.issuer">ë°œí–‰ì‚¬</div>
        <div class="qs-value" id="qs-issuer" style="font-size:0.82rem">â€”</div>
      </div>
      <div class="qs-item">
        <div class="qs-label" data-i18n="detail.qs.benchmark">ë²¤ì¹˜ë§ˆí¬</div>
        <div class="qs-value" id="qs-bench" style="font-size:0.78rem">â€”</div>
      </div>
      <div class="qs-item">
        <div class="qs-label" data-i18n="detail.qs.holdings">êµ¬ì„± ì¢…ëª© ìˆ˜</div>
        <div class="qs-value" id="qs-numh">â€”</div>
      </div>
    </div>

    <!-- â”€â”€ ì»¨í…ì¸  ê·¸ë¦¬ë“œ â”€â”€ -->
    <div class="content-grid">

      <!-- â”€â”€ ì™¼ìª½ ì»¬ëŸ¼ â”€â”€ -->
      <div>

        <!-- ì°¨íŠ¸ ì¹´ë“œ -->
        <div class="glass card" id="chart-card">
          <div class="card-title" data-i18n="detail.chart.title">ê°€ê²© ì°¨íŠ¸</div>
          <div class="chart-toolbar">
            <div style="display:flex;gap:4px">
              <button class="chart-type-btn active" data-type="line" onclick="setChartType('line')">ë¼ì¸</button>
              <button class="chart-type-btn" data-type="candle" onclick="setChartType('candle')">ìº”ë“¤</button>
            </div>
            <div style="display:flex;gap:6px;align-items:center">
              <span style="font-size:0.68rem;color:#334155">ìŠ¤í¬ë¡¤ í™•ëŒ€/ì¶•ì†Œ &nbsp;Â·&nbsp; ë“œë˜ê·¸ ì´ë™</span>
              <button class="ind-settings-btn" id="ind-settings-btn" onclick="toggleIndicatorPanel()">âš™ ì§€í‘œ</button>
            </div>
          </div>
          <!-- ì§€í‘œ ì„¤ì • íŒ¨ë„ -->
          <div class="ind-panel" id="ind-panel">
            <div class="ind-panel-section">
              <div class="ind-panel-label">ì˜¤ë²„ë ˆì´</div>
              <div class="ind-grid">
                <label class="ind-item"><input type="checkbox" id="ind-ma20" onchange="toggleIndicator('ma20',this.checked)"><span class="ind-swatch" style="background:#f59e0b"></span>MA 20</label>
                <label class="ind-item"><input type="checkbox" id="ind-ma50" onchange="toggleIndicator('ma50',this.checked)"><span class="ind-swatch" style="background:#3b82f6"></span>MA 50</label>
                <label class="ind-item"><input type="checkbox" id="ind-ma200" checked onchange="toggleIndicator('ma200',this.checked)"><span class="ind-swatch" style="background:#a78bfa"></span>MA 200</label>
                <label class="ind-item"><input type="checkbox" id="ind-bb" onchange="toggleIndicator('bb',this.checked)"><span class="ind-swatch" style="background:#60a5fa"></span>ë³¼ë¦°ì €ë°´ë“œ (20,2)</label>
              </div>
            </div>
            <div class="ind-panel-section" style="margin-bottom:0">
              <div class="ind-panel-label">ì„œë¸Œì°¨íŠ¸</div>
              <div class="ind-grid">
                <label class="ind-item"><input type="checkbox" id="ind-volume" onchange="toggleIndicator('volume',this.checked)"><span class="ind-swatch" style="background:#60a5fa"></span>ê±°ë˜ëŸ‰</label>
                <label class="ind-item"><input type="checkbox" id="ind-rsi" checked onchange="toggleIndicator('rsi',this.checked)"><span class="ind-swatch" style="background:#f59e0b"></span>RSI (14)</label>
                <label class="ind-item"><input type="checkbox" id="ind-zscore" checked onchange="toggleIndicator('zscore',this.checked)"><span class="ind-swatch" style="background:#a78bfa"></span>Z-Score</label>
                <label class="ind-item"><input type="checkbox" id="ind-range52w" onchange="toggleIndicator('range52w',this.checked)"><span class="ind-swatch" style="background:#34d399"></span>52W Range</label>
                <label class="ind-item"><input type="checkbox" id="ind-mdd" onchange="toggleIndicator('mdd',this.checked)"><span class="ind-swatch" style="background:#f87171"></span>MDD</label>
              </div>
            </div>
          </div>
          <div class="chart-stat">
            <div>
              <div class="chart-pct" id="chart-pct">â€”</div>
              <div class="chart-period-label" id="chart-period-label">í‘œì‹œ êµ¬ê°„ ìˆ˜ìµë¥ </div>
            </div>
            <div style="text-align:right;font-size:0.75rem;color:var(--text-muted)">
              CAGR <span id="chart-cagr" style="font-weight:700;color:#94a3b8">â€”</span>
              &nbsp;Â·&nbsp; Vol <span id="chart-vol" style="font-weight:700;color:#94a3b8">â€”</span>
            </div>
          </div>
          <div class="chart-container" id="chart-container">
            <div id="price-tooltip"></div>
          </div>
          <div id="sub-charts-wrapper"></div>
        </div>

        <!-- ê¸°ê°„ë³„ ìˆ˜ìµë¥  ì¹´ë“œ -->
        <div class="glass card">
          <div class="card-title" data-i18n="detail.perf.title">ê¸°ê°„ë³„ ìˆ˜ìµë¥ </div>
          <table class="perf-table">
            <thead>
              <tr>
                <th data-i18n="detail.perf.period">ê¸°ê°„</th>
                <th data-i18n="detail.perf.return">ìˆ˜ìµë¥ </th>
                <th data-i18n="detail.perf.ann">ì—°í™˜ì‚°</th>
              </tr>
            </thead>
            <tbody id="perf-table-body"></tbody>
          </table>
        </div>

        <!-- ìƒìœ„ êµ¬ì„±ì¢…ëª© ì¹´ë“œ -->
        <div class="glass card">
          <div class="card-title" data-i18n="detail.holdings.title">ìƒìœ„ 10ê°œ êµ¬ì„±ì¢…ëª©</div>
          <div id="holdings-container"></div>
        </div>


      </div>

      <!-- â”€â”€ ì˜¤ë¥¸ìª½ ì»¬ëŸ¼ â”€â”€ -->
      <div>

        <!-- ë¶„ì„ ì§€í‘œ ì¹´ë“œ -->
        <div class="glass card">
          <div class="card-title" data-i18n="detail.analytics.title">CORRYU ë¶„ì„ ì§€í‘œ</div>
          <div id="metrics-container"></div>
        </div>

        <!-- í€ë“œ ì •ë³´ ì¹´ë“œ -->
        <div class="glass card">
          <div class="card-title" data-i18n="detail.info.title">í€ë“œ ê¸°ë³¸ ì •ë³´</div>
          <div id="fund-info-container"></div>
        </div>

        <!-- ë°ì´í„° ê¸°ì¤€ ì•ˆë‚´ -->
        <div class="data-note">
          <div style="font-weight:700;color:#475569;margin-bottom:6px;font-size:0.75rem" data-i18n="detail.data.note">ğŸ“‹ ë°ì´í„° ì•ˆë‚´</div>
          <div><span data-i18n="detail.datadate">ë°ì´í„° ê¸°ì¤€ì¼:</span> <strong id="note-datadate" style="color:#94a3b8">2026-02-26</strong></div>
          <div style="margin-top:4px" data-i18n="detail.data.line1">Z-ScoreÂ·RSIÂ·52W Range ë“± ë¶„ì„ ì§€í‘œëŠ” CORRYUê°€ ì§ì ‘ ì‚°ì¶œí•œ ìˆ˜ì¹˜ì…ë‹ˆë‹¤.</div>
          <div style="margin-top:4px" data-i18n="detail.data.line2">ìˆ˜ìˆ˜ë£ŒÂ·êµ¬ì„±ì¢…ëª© ë¹„ìœ¨ì€ ì˜ˆì‹œ ë°ì´í„°ì´ë©°, ì‹¤ì œì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
          <div style="margin-top:4px" data-i18n="detail.data.line3">ë³¸ ìë£ŒëŠ” íˆ¬ì ê¶Œìœ ê°€ ì•„ë‹™ë‹ˆë‹¤. íˆ¬ì íŒë‹¨ì€ ë³¸ì¸ì˜ ì±…ì„ì…ë‹ˆë‹¤.</div>
        </div>

      </div>
    </div>
  </div><!-- /page-content -->

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- ğŸ’¬ ì¢…ëª© í† ë¡  (ëŒ“ê¸€)                                            -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="comment-section" style="display:none;margin-top:16px">
  <div style="background:rgba(18,22,36,0.92);backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,0.07);border-radius:14px;padding:22px 24px">

    <!-- í—¤ë” -->
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:8px">
      <div style="display:flex;align-items:center;gap:10px">
        <span style="font-size:1.05rem;font-weight:900;letter-spacing:-.02em" data-i18n="detail.comments.title">ğŸ’¬ ì¢…ëª© í† ë¡ </span>
        <span id="c-total-badge" style="padding:2px 8px;border-radius:10px;background:rgba(59,130,246,0.12);border:1px solid rgba(59,130,246,0.25);color:#60a5fa;font-size:.72rem;font-weight:800">0</span>
      </div>
      <div style="display:flex;gap:4px">
        <button class="c-sort-btn c-sort-on" data-sort="recent" onclick="setSortBy('recent')" data-i18n="detail.comments.latest">ìµœì‹ ìˆœ</button>
        <button class="c-sort-btn" data-sort="likes" onclick="setSortBy('likes')" data-i18n="detail.comments.popular">ì¸ê¸°ìˆœ</button>
      </div>
    </div>

    <!-- ë¯¸ì—°ê²° ìƒíƒœ ë°°ë„ˆ -->
    <div id="c-not-configured" style="display:none;text-align:center;padding:28px;color:#334155;font-size:.82rem;border:1px dashed rgba(255,255,255,0.06);border-radius:10px;margin-bottom:12px">
      <div style="font-size:1.4rem;margin-bottom:6px">âš™ï¸</div>
      ëŒ“ê¸€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ <code style="color:#60a5fa">supabase-client.js</code>ì— Supabase URLÂ·Keyë¥¼ ì„¤ì •í•˜ê³ <br>
      <code>supabase_migration.sql</code>ì„ ì‹¤í–‰í•˜ì„¸ìš”.
    </div>

    <!-- ë¡œê·¸ì¸ ë°°ë„ˆ (ë¯¸ë¡œê·¸ì¸ ì‹œ) -->
    <div id="c-login-banner" style="display:none;margin-bottom:12px">
      <a href="#" onclick="goLogin(event)" style="display:flex;align-items:center;gap:10px;padding:12px 16px;border-radius:10px;background:rgba(59,130,246,0.07);border:1px solid rgba(59,130,246,0.2);text-decoration:none;color:#94a3b8;transition:background .15s" onmouseover="this.style.background='rgba(59,130,246,0.12)'" onmouseout="this.style.background='rgba(59,130,246,0.07)'">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#60a5fa" stroke-width="2"><path d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>
        <span style="font-size:.84rem;font-weight:600;color:#60a5fa" data-i18n="detail.comments.login.prompt">ë¡œê·¸ì¸í•˜ê³  ëŒ“ê¸€ ì‘ì„±í•˜ê¸°</span>
        <span style="margin-left:auto;font-size:.72rem" data-i18n="detail.comments.signup">íšŒì›ê°€ì… â†’</span>
      </a>
    </div>

    <!-- ì‘ì„± í¼ (ë¡œê·¸ì¸ ì‹œ) -->
    <div id="c-write-form" style="display:none;margin-bottom:16px">
      <div style="display:flex;gap:10px;align-items:flex-start">
        <div id="c-my-avatar" style="width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:.84rem;flex-shrink:0"></div>
        <div style="flex:1">
          <textarea id="c-textarea" data-i18n-placeholder="detail.comments.placeholder" placeholder="ì´ ì¢…ëª©ì— ëŒ€í•œ ì˜ê²¬ì„ ë‚¨ê²¨ë³´ì„¸ìš”â€¦" maxlength="2000"
            style="width:100%;min-height:72px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:9px;color:#e2e8f0;font-size:.84rem;font-family:inherit;padding:10px 12px;outline:none;resize:vertical;transition:border .15s;line-height:1.5"
            onfocus="this.style.borderColor='rgba(59,130,246,0.45)'" onblur="this.style.borderColor='rgba(255,255,255,0.08)'"></textarea>
          <div style="display:flex;align-items:center;justify-content:space-between;margin-top:6px">
            <span id="c-char-count" style="font-size:.68rem;color:#334155">0 / 2000</span>
            <button onclick="submitTopComment()" style="padding:6px 16px;border-radius:7px;background:#3b82f6;border:none;color:#fff;font-size:.8rem;font-weight:700;cursor:pointer;font-family:inherit;transition:opacity .15s" onmouseover="this.style.opacity='.85'" onmouseout="this.style.opacity='1'" data-i18n="detail.comments.submit">ëŒ“ê¸€ ë“±ë¡ â†’</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ëŒ“ê¸€ ëª©ë¡ -->
    <div id="c-list" style="display:flex;flex-direction:column;gap:2px"></div>

    <!-- ë” ë³´ê¸° ë¡œë”© -->
    <div id="c-load-more" style="display:none;text-align:center;margin-top:12px">
      <button onclick="loadMoreComments()" style="padding:7px 20px;border-radius:8px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);color:#94a3b8;font-size:.78rem;font-weight:700;cursor:pointer;font-family:inherit" data-i18n="detail.comments.more">ë” ë³´ê¸°</button>
    </div>

    <!-- ê²ŒìŠ¤íŠ¸ ê²Œì´íŠ¸ (ë¯¸ë¡œê·¸ì¸ + ëŒ“ê¸€ ìˆì„ ë•Œ) -->
    <div id="c-guest-gate" style="display:none;position:relative;margin-top:-60px">
      <div style="height:80px;background:linear-gradient(to bottom,transparent,rgba(10,13,20,0.97));pointer-events:none"></div>
      <div style="text-align:center;padding:20px 16px 8px;background:rgba(10,13,20,0.97)">
        <div style="font-size:.84rem;color:#475569;margin-bottom:10px" data-i18n="detail.comments.gate">ğŸ”’ ë‚˜ë¨¸ì§€ ëŒ“ê¸€ì€ ë¡œê·¸ì¸ í›„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
        <a href="#" onclick="goLogin(event)" style="display:inline-flex;align-items:center;gap:6px;padding:8px 20px;border-radius:9px;background:linear-gradient(135deg,#3b82f6,#8b5cf6);color:#fff;font-size:.82rem;font-weight:700;text-decoration:none" data-i18n="detail.comments.signup.link">ë¬´ë£Œ íšŒì›ê°€ì… Â· ë¡œê·¸ì¸</a>
      </div>
    </div>

    <!-- ë¹ˆ ìƒíƒœ -->
    <div id="c-empty" style="display:none;text-align:center;padding:36px;color:#334155">
      <div style="font-size:1.6rem;margin-bottom:8px">ğŸ’¬</div>
      <div style="font-size:.84rem" data-i18n="detail.comments.empty">ì•„ì§ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ì˜ê²¬ì„ ë‚¨ê²¨ë³´ì„¸ìš”!</div>
    </div>

    <div style="font-size:.63rem;color:#1e293b;margin-top:14px;text-align:right" data-i18n="detail.comments.guidelines">ì»¤ë®¤ë‹ˆí‹° ê°€ì´ë“œë¼ì¸ì„ ì§€ì¼œ ê±´ê°•í•œ í† ë¡  ë¬¸í™”ë¥¼ ë§Œë“¤ì–´ì£¼ì„¸ìš”.</div>
  </div>
  </div><!-- /comment-section -->

</div><!-- /main-wrap -->

<script>
// â”€â”€ ë³´ì¡° ë°ì´í„° (ìˆ˜ìˆ˜ë£ŒÂ·ë°œí–‰ì‚¬Â·êµ¬ì„±ì¢…ëª© ë“± etf_data.jsonì— ì—†ëŠ” ì •ë³´) â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SUPP = {
  'SPY':  { exp:'0.0945%', issuer:'State Street Global Advisors', bench:'S&P 500',           structure:'UIT', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.24%', numH:503,
            desc:'S&P 500 ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•˜ëŠ” ì„¸ê³„ ìµœì´ˆÂ·ìµœëŒ€ ê·œëª¨ì˜ ETF. ë¯¸êµ­ ëŒ€í˜•ì£¼ 500ê°œë¥¼ ì‹œê°€ì´ì•¡ ê°€ì¤‘ ë°©ì‹ìœ¼ë¡œ ë³´ìœ í•©ë‹ˆë‹¤.',
            holdings:[['AAPL','Apple Inc.',7.32],['MSFT','Microsoft Corp.',6.81],['NVDA','NVIDIA Corp.',5.94],['AMZN','Amazon.com Inc.',3.78],['META','Meta Platforms',2.65],['GOOGL','Alphabet Class A',2.10],['GOOG','Alphabet Class C',1.82],['BRK.B','Berkshire Hathaway B',1.63],['LLY','Eli Lilly & Co.',1.52],['JPM','JPMorgan Chase',1.47]],
            perf:{'1M':2.3,'3M':5.1,'YTD':8.7,'1Y':22.4,'3Y_ann':12.1,'5Y_ann':14.7} },
  'QQQ':  { exp:'0.20%',  issuer:'Invesco',                       bench:'Nasdaq-100',         structure:'Open-End',  div:'ë¶„ê¸° ë°°ë‹¹', divYield:'0.55%', numH:101,
            desc:'Nasdaq-100 ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•˜ë©° ê¸°ìˆ Â·ì„±ì¥ì£¼ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±ëœ ETF. FAANG ë° ëŒ€í˜• ê¸°ìˆ ì£¼ ë¹„ì¤‘ì´ ë†’ìŠµë‹ˆë‹¤.',
            holdings:[['AAPL','Apple Inc.',9.15],['MSFT','Microsoft Corp.',8.44],['NVDA','NVIDIA Corp.',7.92],['AMZN','Amazon.com Inc.',5.02],['META','Meta Platforms',4.81],['GOOGL','Alphabet Class A',2.72],['GOOG','Alphabet Class C',2.58],['TSLA','Tesla Inc.',2.35],['AVGO','Broadcom Inc.',2.21],['COST','Costco Wholesale',1.86]],
            perf:{'1M':3.1,'3M':7.8,'YTD':12.3,'1Y':28.5,'3Y_ann':15.4,'5Y_ann':19.2} },
  'IVV':  { exp:'0.03%',  issuer:'BlackRock (iShares)',           bench:'S&P 500',             structure:'Open-End',  div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.26%', numH:503,
            desc:'iShares Core S&P 500 ETF. 0.03%ì˜ ìµœì € ìˆ˜ìˆ˜ë£Œë¡œ S&P 500 ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•©ë‹ˆë‹¤.',
            holdings:[['AAPL','Apple Inc.',7.32],['MSFT','Microsoft Corp.',6.81],['NVDA','NVIDIA Corp.',5.94],['AMZN','Amazon.com Inc.',3.78],['META','Meta Platforms',2.65],['GOOGL','Alphabet Class A',2.10],['GOOG','Alphabet Class C',1.82],['BRK.B','Berkshire Hathaway B',1.63],['LLY','Eli Lilly & Co.',1.52],['JPM','JPMorgan Chase',1.47]],
            perf:{'1M':2.3,'3M':5.1,'YTD':8.7,'1Y':22.4,'3Y_ann':12.1,'5Y_ann':14.7} },
  'VOO':  { exp:'0.03%',  issuer:'Vanguard',                      bench:'S&P 500',             structure:'Open-End',  div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.25%', numH:503,
            desc:'Vanguard S&P 500 ETF. ì—…ê³„ ìµœì € ìˆ˜ì¤€ì˜ ìˆ˜ìˆ˜ë£Œë¡œ S&P 500 ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•©ë‹ˆë‹¤.',
            holdings:[['AAPL','Apple Inc.',7.31],['MSFT','Microsoft Corp.',6.80],['NVDA','NVIDIA Corp.',5.93],['AMZN','Amazon.com Inc.',3.77],['META','Meta Platforms',2.64],['GOOGL','Alphabet Class A',2.09],['GOOG','Alphabet Class C',1.81],['BRK.B','Berkshire Hathaway B',1.62],['LLY','Eli Lilly & Co.',1.51],['JPM','JPMorgan Chase',1.46]],
            perf:{'1M':2.3,'3M':5.1,'YTD':8.7,'1Y':22.3,'3Y_ann':12.0,'5Y_ann':14.6} },
  'VTI':  { exp:'0.03%',  issuer:'Vanguard',                      bench:'CRSP US Total Market',structure:'Open-End',  div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.35%', numH:3615,
            desc:'ë¯¸êµ­ ì „ì²´ ì£¼ì‹ ì‹œì¥(ëŒ€í˜•Â·ì¤‘í˜•Â·ì†Œí˜•ì£¼ í¬í•¨)ì— í•œ ë²ˆì— íˆ¬ìí•˜ëŠ” Total Market ETF.',
            holdings:[['AAPL','Apple Inc.',6.42],['MSFT','Microsoft Corp.',5.96],['NVDA','NVIDIA Corp.',5.21],['AMZN','Amazon.com Inc.',3.31],['META','Meta Platforms',2.32],['GOOGL','Alphabet Class A',1.84],['BRK.B','Berkshire Hathaway B',1.64],['GOOG','Alphabet Class C',1.59],['LLY','Eli Lilly & Co.',1.33],['JPM','JPMorgan Chase',1.28]],
            perf:{'1M':2.1,'3M':4.8,'YTD':8.2,'1Y':21.8,'3Y_ann':11.7,'5Y_ann':14.3} },
  'GLD':  { exp:'0.40%',  issuer:'State Street Global Advisors', bench:'LBMA Gold Price',      structure:'Grantor Trust', div:'ë¬´ë°°ë‹¹', divYield:'0%', numH:1,
            desc:'ì‹¤ë¬¼ ê¸ˆ ê°€ê²©ì„ ì¶”ì¢…í•˜ëŠ” ì„¸ê³„ ìµœëŒ€ ê¸ˆ ETF. ì£¼ë‹¹ ì•½ 1/10 íŠ¸ë¡œì´ì˜¨ìŠ¤ì˜ ê¸ˆì„ ë³´ìœ í•©ë‹ˆë‹¤.',
            holdings:[['GOLD','Physical Gold (0.1 oz/share)',100.0]],
            perf:{'1M':1.8,'3M':9.2,'YTD':11.4,'1Y':18.7,'3Y_ann':8.3,'5Y_ann':11.2} },
  'TLT':  { exp:'0.15%',  issuer:'BlackRock (iShares)',           bench:'ICE US Treasury 20+Y', structure:'Open-End', div:'ì›” ë°°ë‹¹', divYield:'4.12%', numH:26,
            desc:'ë§Œê¸° 20ë…„ ì´ìƒ ë¯¸êµ­ ì¥ê¸° êµ­ì±„ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF. ê¸ˆë¦¬ í•˜ë½ ì‹œ ìˆ˜ìµ, ê¸ˆë¦¬ ìƒìŠ¹ ì‹œ ì†ì‹¤ì´ ë‘ë“œëŸ¬ì§‘ë‹ˆë‹¤.',
            holdings:[['UST1','US Treasury 4.500% 2054',15.2],['UST2','US Treasury 4.125% 2054',9.8],['UST3','US Treasury 3.875% 2053',8.7],['UST4','US Treasury 4.250% 2052',7.3],['UST5','US Treasury 3.000% 2048',6.1],['UST6','US Treasury 2.250% 2052',5.4],['UST7','US Treasury 3.625% 2053',5.2],['UST8','US Treasury 1.875% 2051',4.8],['UST9','US Treasury 2.375% 2049',4.3],['UST10','US Treasury 2.875% 2049',3.9]],
            perf:{'1M':-1.2,'3M':-3.4,'YTD':-4.1,'1Y':-8.3,'3Y_ann':-12.4,'5Y_ann':-6.8} },
  'XLK':  { exp:'0.09%',  issuer:'State Street Global Advisors', bench:'S&P Technology Select Sector', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'0.68%', numH:67,
            desc:'S&P 500 ë‚´ ê¸°ìˆ  ì„¹í„° ê¸°ì—…ì„ ëª¨ë‘ ë‹´ì€ ETF. ì†Œí”„íŠ¸ì›¨ì–´Â·í•˜ë“œì›¨ì–´Â·ë°˜ë„ì²´ ê¸°ì—…ì„ í¬í•¨í•©ë‹ˆë‹¤.',
            holdings:[['MSFT','Microsoft Corp.',22.81],['AAPL','Apple Inc.',20.05],['NVDA','NVIDIA Corp.',17.42],['AVGO','Broadcom Inc.',4.62],['ORCL','Oracle Corp.',3.18],['CSCO','Cisco Systems',3.05],['ADBE','Adobe Inc.',2.34],['CRM','Salesforce Inc.',2.21],['ACN','Accenture PLC',2.14],['AMD','Advanced Micro Devices',1.97]],
            perf:{'1M':4.2,'3M':9.8,'YTD':15.4,'1Y':34.2,'3Y_ann':18.6,'5Y_ann':22.8} },
  'XLF':  { exp:'0.09%',  issuer:'State Street Global Advisors', bench:'S&P Financials Select Sector', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.68%', numH:72,
            desc:'S&P 500 ë‚´ ê¸ˆìœµ ì„¹í„°(ì€í–‰Â·ë³´í—˜Â·íˆ¬ìì€í–‰Â·ì¹´ë“œ)ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF.',
            holdings:[['BRK.B','Berkshire Hathaway B',13.24],['JPM','JPMorgan Chase',12.81],['V','Visa Inc.',8.34],['MA','Mastercard Inc.',7.12],['BAC','Bank of America',4.62],['WFC','Wells Fargo',4.21],['GS','Goldman Sachs',3.84],['MS','Morgan Stanley',3.41],['SPGI','S&P Global Inc.',2.95],['BLK','BlackRock Inc.',2.78]],
            perf:{'1M':1.8,'3M':4.2,'YTD':7.1,'1Y':18.4,'3Y_ann':10.2,'5Y_ann':12.1} },
  'XLV':  { exp:'0.09%',  issuer:'State Street Global Advisors', bench:'S&P Healthcare Select Sector', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.42%', numH:63,
            desc:'S&P 500 ë‚´ í—¬ìŠ¤ì¼€ì–´ ì„¹í„°(ì œì•½Â·ë°”ì´ì˜¤Â·ì˜ë£Œê¸°ê¸°Â·ë³´í—˜)ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF.',
            holdings:[['LLY','Eli Lilly & Co.',12.84],['UNH','UnitedHealth Group',11.42],['JNJ','Johnson & Johnson',8.35],['ABBV','AbbVie Inc.',7.23],['MRK','Merck & Co.',6.84],['TMO','Thermo Fisher',4.21],['DHR','Danaher Corp.',3.82],['ABT','Abbott Laboratories',3.41],['PFE','Pfizer Inc.',3.12],['AMGN','Amgen Inc.',2.94]],
            perf:{'1M':0.8,'3M':2.4,'YTD':4.1,'1Y':10.2,'3Y_ann':8.4,'5Y_ann':10.8} },
  'XLE':  { exp:'0.09%',  issuer:'State Street Global Advisors', bench:'S&P Energy Select Sector', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'3.42%', numH:22,
            desc:'S&P 500 ë‚´ ì—ë„ˆì§€ ì„¹í„°(ì •ìœ Â·ê°€ìŠ¤Â·ì •ì œÂ·ì„œë¹„ìŠ¤)ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF.',
            holdings:[['XOM','Exxon Mobil Corp.',23.74],['CVX','Chevron Corp.',18.32],['COP','ConocoPhillips',6.84],['EOG','EOG Resources',5.21],['MPC','Marathon Petroleum',4.87],['SLB','SLB (Schlumberger)',4.62],['PSX','Phillips 66',4.38],['VLO','Valero Energy',3.95],['OXY','Occidental Petroleum',3.42],['KMI','Kinder Morgan',2.87]],
            perf:{'1M':-1.4,'3M':-2.8,'YTD':-3.2,'1Y':4.2,'3Y_ann':22.4,'5Y_ann':16.8} },
  'IWM':  { exp:'0.19%',  issuer:'BlackRock (iShares)',           bench:'Russell 2000',        structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.23%', numH:2000,
            desc:'ë¯¸êµ­ ì†Œí˜•ì£¼ ì•½ 2,000ê°œë¡œ êµ¬ì„±ëœ Russell 2000 ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•©ë‹ˆë‹¤. ë¯¸êµ­ ë‚´ìˆ˜ ê²½ê¸°ì— ë¯¼ê°í•©ë‹ˆë‹¤.',
            holdings:[['SMCI','Super Micro Computer',0.52],['MTSI','MACOM Technology',0.41],['VIRT','Virtu Financial',0.38],['SPSC','SPS Commerce',0.36],['MGNI','Magnite Inc.',0.34],['AEIS','Advanced Energy Ind.',0.33],['TMDX','TransMedics Group',0.32],['SKYW','SkyWest Inc.',0.31],['CTRE','CareTrust REIT',0.30],['HALO','Halozyme Therapeutics',0.29]],
            perf:{'1M':1.2,'3M':3.4,'YTD':5.8,'1Y':14.2,'3Y_ann':6.4,'5Y_ann':9.1} },
  'VEA':  { exp:'0.05%',  issuer:'Vanguard',                      bench:'FTSE Dev. All Cap ex US', structure:'Open-End', div:'ë°˜ê¸° ë°°ë‹¹', divYield:'2.98%', numH:3900,
            desc:'ë¯¸êµ­Â·ìºë‚˜ë‹¤ë¥¼ ì œì™¸í•œ ì„ ì§„êµ­ ì£¼ì‹(ìœ ëŸ½Â·ì¼ë³¸Â·í˜¸ì£¼ ë“±)ì— íˆ¬ìí•˜ëŠ” ETF.',
            holdings:[['NESN','NestlÃ© S.A.',1.82],['ASML','ASML Holding',1.74],['NOVN','Novartis AG',1.41],['RHHBY','Roche Holding',1.38],['SAP','SAP SE',1.35],['TM','Toyota Motor',1.31],['RDSA','Shell plc',1.24],['AZN','AstraZeneca',1.22],['SIE','Siemens AG',1.18],['HSBC','HSBC Holdings',1.14]],
            perf:{'1M':1.8,'3M':4.1,'YTD':6.3,'1Y':10.4,'3Y_ann':5.2,'5Y_ann':7.8} },
  'VWO':  { exp:'0.08%',  issuer:'Vanguard',                      bench:'FTSE Emerging Markets', structure:'Open-End', div:'ë°˜ê¸° ë°°ë‹¹', divYield:'3.42%', numH:5600,
            desc:'ì¤‘êµ­Â·ì¸ë„Â·ë¸Œë¼ì§ˆÂ·í•œêµ­ ë“± ì‹ í¥êµ­ ì£¼ì‹ ì‹œì¥ì— íˆ¬ìí•˜ëŠ” ETF.',
            holdings:[['TSM','Taiwan Semiconductor',5.84],['BABA','Alibaba Group',3.42],['TCS','Tata Consultancy',2.18],['RELI','Reliance Industries',2.04],['PDD','PDD Holdings',1.94],['SMSN','Samsung Electronics',1.87],['JD','JD.com Inc.',1.52],['BIDU','Baidu Inc.',1.41],['INFY','Infosys Ltd.',1.32],['MBT','Mobile TeleSystems',1.24]],
            perf:{'1M':1.4,'3M':3.8,'YTD':5.2,'1Y':8.4,'3Y_ann':2.1,'5Y_ann':4.8} },
  'VNQ':  { exp:'0.13%',  issuer:'Vanguard',                      bench:'MSCI US IMI Real Estate 25/50', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'3.85%', numH:163,
            desc:'ë¯¸êµ­ ë¶€ë™ì‚° íˆ¬ìì‹ íƒ(REITs)ê³¼ ë¶€ë™ì‚° ê´€ë ¨ ê¸°ì—…ì— íˆ¬ìí•˜ëŠ” ETF.',
            holdings:[['PLD','Prologis Inc.',5.91],['AMT','American Tower',4.83],['EQIX','Equinix Inc.',4.12],['WELL','Welltower Inc.',3.47],['SPG','Simon Property Group',3.22],['DLR','Digital Realty',2.98],['PSA','Public Storage',2.76],['O','Realty Income Corp.',2.65],['CCI','Crown Castle',2.41],['WY','Weyerhaeuser',2.14]],
            perf:{'1M':1.4,'3M':3.8,'YTD':4.2,'1Y':12.3,'3Y_ann':2.8,'5Y_ann':7.4} },
  'HYG':  { exp:'0.48%',  issuer:'BlackRock (iShares)',           bench:'iBoxx USD Liquid HY', structure:'Open-End', div:'ì›” ë°°ë‹¹', divYield:'5.82%', numH:1195,
            desc:'ë¯¸êµ­ íˆ¬ê¸°ë“±ê¸‰(í•˜ì´ì¼ë“œ) íšŒì‚¬ì±„ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF. ë†’ì€ ë°°ë‹¹ ìˆ˜ìµë¥ ê³¼ ì‹ ìš© ë¦¬ìŠ¤í¬ê°€ íŠ¹ì§•.',
            holdings:[['HY01','T-Mobile USA 3.875% 2030',0.58],['HY02','Telecom Italia 5.303% 2034',0.45],['HY03','Carnival Corp. 6.000% 2029',0.43],['HY04','Ford Motor 4.750% 2043',0.41],['HY05','CCO Holdings 4.500% 2032',0.38],['HY06','Netflix Inc. 4.875% 2030',0.36],['HY07','Centene Corp. 4.625% 2029',0.35],['HY08','Bausch Health 5.250% 2030',0.33],['HY09','DISH DBS 5.875% 2024',0.32],['HY10','Pitney Bowes 6.350% 2037',0.31]],
            perf:{'1M':0.8,'3M':2.1,'YTD':1.9,'1Y':8.7,'3Y_ann':4.2,'5Y_ann':4.8} },
  'BND':  { exp:'0.03%',  issuer:'Vanguard',                      bench:'Bloomberg US Aggregate', structure:'Open-End', div:'ì›” ë°°ë‹¹', divYield:'3.72%', numH:10418,
            desc:'ë¯¸êµ­ íˆ¬ìë“±ê¸‰ ì±„ê¶Œ ì „ì²´(êµ­ì±„Â·íšŒì‚¬ì±„Â·MBS)ë¥¼ ì¶”ì¢…í•˜ëŠ” ì¢…í•© ì±„ê¶Œ ETF.',
            holdings:[['UST','US Treasury Notes/Bonds',44.21],['GNMA','GNMA (ì •ë¶€ ëª¨ê¸°ì§€)',20.14],['FNMA','Fannie Mae MBS',15.38],['CORP','Investment Grade Corp',12.41],['FHLMC','Freddie Mac MBS',5.83],['ABS','Asset-Backed Securities',2.03]],
            perf:{'1M':0.4,'3M':1.2,'YTD':0.8,'1Y':2.3,'3Y_ann':-1.8,'5Y_ann':0.4} },
  'GBTC': { exp:'1.50%',  issuer:'Grayscale Investments',         bench:'Bitcoin Price',        structure:'Spot BTC ETF', div:'ë¬´ë°°ë‹¹', divYield:'0%', numH:1,
            desc:'ë¯¸êµ­ SEC ìŠ¹ì¸ í˜„ë¬¼ ë¹„íŠ¸ì½”ì¸ ETF. ë¹„íŠ¸ì½”ì¸ì„ ì§ì ‘ ë³´ìœ í•˜ë©°, BTC ê°€ê²©ì„ 1:1ë¡œ ì¶”ì¢…í•©ë‹ˆë‹¤.',
            holdings:[['BTC','Bitcoin (BTC)',100.0]],
            perf:{'1M':12.4,'3M':38.7,'YTD':45.2,'1Y':124.3,'3Y_ann':28.4,'5Y_ann':48.7} },
  'SQQQ': { exp:'0.95%',  issuer:'ProShares',                     bench:'Nasdaq-100 Ã— âˆ’3',      structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'3.21%', numH:0,
            desc:'Nasdaq-100 ì§€ìˆ˜ì˜ ì¼ì¼ ìˆ˜ìµë¥  Ã—âˆ’3ë°°ë¥¼ ì¶”ì¢…í•˜ëŠ” ì¸ë²„ìŠ¤ ë ˆë²„ë¦¬ì§€ ETF. ë‹¨ê¸° í•˜ë½ ë² íŒ…Â·í—¤ì§• ëª©ì .',
            holdings:[],
            perf:{'1M':-8.9,'3M':-21.4,'YTD':-34.2,'1Y':-67.4,'3Y_ann':-42.8,'5Y_ann':-51.3} },
  'PEY':  { exp:'0.53%',  issuer:'Invesco',                       bench:'NASDAQ US Dividend Achievers 50', structure:'Open-End', div:'ì›” ë°°ë‹¹', divYield:'4.87%', numH:50,
            desc:'ë¯¸êµ­ ê³ ë°°ë‹¹ ìš°ëŸ‰ì£¼ 50ê°œë¥¼ ì„ ë³„í•´ ë°°ë‹¹ ì„±ì¥ ì‹¤ì ì— ë”°ë¼ íˆ¬ìí•˜ëŠ” ETF. ì›” ë°°ë‹¹ì´ íŠ¹ì§•.',
            holdings:[['ALT','Altria Group Inc.',2.42],['T','AT&T Inc.',2.35],['LEG','Leggett & Platt',2.31],['UVV','Universal Corp.',2.28],['HEP','Holly Energy Partners',2.24],['BKH','Black Hills Corp.',2.21],['ESS','Essex Property Trust',2.18],['OHI','Omega Healthcare',2.15],['LAMR','Lamar Advertising',2.12],['NNN','National Retail Prop.',2.09]],
            perf:{'1M':0.8,'3M':2.4,'YTD':3.2,'1Y':8.4,'3Y_ann':4.2,'5Y_ann':7.8} },
  'UYR':  { exp:'0.95%',  issuer:'ProShares',                     bench:'Dow Jones US Real Estate Ã— 2', structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'1.84%', numH:30,
            desc:'ë¯¸êµ­ ë¶€ë™ì‚°(REITs) ì§€ìˆ˜ì˜ ì¼ì¼ ìˆ˜ìµë¥  Ã—2ë°°ë¥¼ ì¶”ì¢…í•˜ëŠ” ë ˆë²„ë¦¬ì§€ ETF.',
            holdings:[['PLD','Prologis (ë ˆë²„ë¦¬ì§€)',5.91],['AMT','American Tower (ë ˆë²„ë¦¬ì§€)',4.83],['EQIX','Equinix (ë ˆë²„ë¦¬ì§€)',4.12]],
            perf:{'1M':2.8,'3M':7.6,'YTD':8.4,'1Y':22.1,'3Y_ann':3.2,'5Y_ann':9.8} },
  'IWF':  { exp:'0.19%',  issuer:'BlackRock (iShares)',           bench:'Russell 1000 Growth',  structure:'Open-End', div:'ë¶„ê¸° ë°°ë‹¹', divYield:'0.52%', numH:415,
            desc:'Russell 1000 ì„±ì¥ì£¼ ì§€ìˆ˜ë¥¼ ì¶”ì¢…í•˜ëŠ” ETF. ê¸°ìˆ Â·í—¬ìŠ¤ì¼€ì–´Â·ì†Œë¹„ì¬ ëŒ€í˜• ì„±ì¥ì£¼ ì¤‘ì‹¬.',
            holdings:[['NVDA','NVIDIA Corp.',12.34],['AAPL','Apple Inc.',12.21],['MSFT','Microsoft Corp.',11.84],['AMZN','Amazon.com',6.42],['META','Meta Platforms',5.81],['GOOGL','Alphabet Class A',4.12],['TSLA','Tesla Inc.',3.84],['AVGO','Broadcom Inc.',3.21],['GOOG','Alphabet Class C',2.95],['LLY','Eli Lilly',2.84]],
            perf:{'1M':3.4,'3M':8.2,'YTD':13.1,'1Y':32.4,'3Y_ann':16.8,'5Y_ann':20.4} },
};

// â”€â”€ ETF ì´ë¦„ ì²« ë‹¨ì–´(ë¸Œëœë“œ)ë¡œ ë°œí–‰ì‚¬ ì¶”ë¡  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ETF ëª…ëª… ê·œì¹™: ë§¨ ì²˜ìŒ ë‹¨ì–´ = ë°œí–‰ì‚¬ ë¸Œëœë“œ
const _ISSUER_PREFIX = {
  // â”€â”€ ëŒ€í˜• (100ê°œ+) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  'iShares':        'BlackRock (iShares)',
  'Ishares':        'BlackRock (iShares)',
  'Invesco':        'Invesco',
  'SPDR':           'State Street Global Advisors',
  'Vanguard':       'Vanguard',
  'WisdomTree':     'WisdomTree',
  'Wisdomtree':     'WisdomTree',
  'ProShares':      'ProShares',
  'Proshares':      'ProShares',
  'First':          'First Trust',       // "First Trust ..."
  'FT':             'First Trust',       // "FT Cboe Vest ..."
  'Global':         'Global X (Mirae Asset)', // "Global X ..."
  'VanEck':         'VanEck',
  'Vaneck':         'VanEck',
  'Fidelity':       'Fidelity Investments',
  'JPMorgan':       'JPMorgan Asset Management',
  'Jpmorgan':       'JPMorgan Asset Management',
  'Direxion':       'Direxion',
  'Schwab':         'Charles Schwab',
  // â”€â”€ ì¤‘í˜• (20~99ê°œ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  'Avantis':        'Avantis Investors',
  'Dimensional':    'Dimensional Fund Advisors',
  'Goldman':        'Goldman Sachs Asset Management',
  'Franklin':       'Franklin Templeton',
  'Xtrackers':      'DWS (Xtrackers)',
  'Nuveen':         'Nuveen',
  'ALPS':           'ALPS Advisors',
  'AdvisorShares':  'AdvisorShares',
  'Roundhill':      'Roundhill Investments',
  'Daily':          'Roundhill Investments',   // "Daily 2X ..." (Roundhill)
  'YieldMax':       'YieldMax',
  'Yieldmax':       'YieldMax',
  'MicroSectors':    'REX Shares (MicroSectors)',
  'MicroSectors\u2122':  'REX Shares (MicroSectors)', // MicroSectorsâ„¢
  'MicroSectorsTM':  'REX Shares (MicroSectors)',
  'MicroSectorsTM':  'REX Shares (MicroSectors)', // MicroSectorsTM (without â„¢)
  'Microsectors':    'REX Shares (MicroSectors)',
  'U.S.':            'US Global Investors',            // "U.S. Global Jets ETF" ë“±
  'ALPS/CoreCommodity': 'ALPS Advisors',               // "ALPS/CoreCommodity Natural Resources"
  'Pacer':          'Pacer Financial',
  'The':            'State Street Global Advisors', // "The ... Select Sector SPDR"
  'Amplify':        'Amplify ETFs',
  'NEOS':           'NEOS Investment Management',
  'Neos':           'NEOS Investment Management',
  // â”€â”€ ì†Œí˜• (10~19ê°œ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  'Tema':           'Tema ETFs',
  'VictoryShares':  'VictoryShares',
  'Victoryshares':  'VictoryShares',
  'Themes':         'Themes ETFs',
  'KraneShares':    'KraneShares',
  'ARK':            'ARK Investment Management',
  'PIMCO':          'PIMCO',
  'T.':             'T. Rowe Price',             // "T. Rowe Price ..."
  'Innovator':      'Innovator Capital Management',
  'Macquarie':      'Macquarie Asset Management',
  'abrdn':          'abrdn',
  'Sprott':         'Sprott Asset Management',
  'Volatility':     'Volatility Shares',
  'Teucrium':       'Teucrium Trading',
  'American':       'American Century Investments',
  'Strive':         'Strive Asset Management',
  'Harbor':         'Harbor Capital Advisors',
  'GraniteShares':  'GraniteShares',
  'Putnam':         'Franklin Templeton',
  'Janus':          'Janus Henderson',
  'Grayscale':      'Grayscale Investments',
  'Bitwise':        'Bitwise Asset Management',
  'Defiance':       'Defiance ETFs',
  'CoinShares':     'CoinShares',
  // â”€â”€ ì†Œìˆ˜ (1~9ê°œ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  'Robo':           'ROBO Global',
  'BNY':            'BNY Mellon',
  'Zacks':          'Zacks Investment Management',
  'RiverFront':     'RiverFront Investment Group',
  'VistaShares':    'VistaShares',
  'Eaton':          'Eaton Vance',
  '2x':             'Volatility Shares',
  '-1x':            'Volatility Shares',
  'One':            'Volatility Shares',        // "One+One S&P 500 and Bitcoin ETF"
  'Davis':          'Davis Advisors',
  'ClearBridge':    'ClearBridge Investments',
  'Tortoise':       'Tortoise Capital',
  'USCF':           'USCF Investments',
  'Alerian':        'SS&C (Alerian)',
  'United':         'United States Commodity Funds',
  'State':          'State Street Global Advisors',
  'Principal':      'Principal Global Investors',
  'US':             'US Global Investors',
  'Transatlantic':  'Transatlantic Capital',
  'Point':          'Point Bridge Capital',
  'Barclays':       'Barclays',
  'Procure':        'Procure Asset Management',
  "Barron's":       'ALPS Advisors',
  'Cambria':        'Cambria Investment Management',
  'Western':        'Franklin Templeton',
  'UBS':            'UBS',
  'Select':         'State Street Global Advisors',
  'Listed':         'Teucrium',               // "Listed Funds Trust / Teucrium"
  'Solana':         'REX Shares',
  '21Shares':       '21Shares',
  '21shares':       '21Shares',
  'Fortuna':        'Fortuna Funds',
};
function inferIssuer(name) {
  if (!name) return '';
  const w = name.trim().split(/\s+/);
  // "T. Rowe Price" â€” ì²« ë‹¨ì–´ê°€ "T."ì´ë©´ ë‘ ë²ˆì§¸ ë‹¨ì–´ë¡œ ë³´ì™„
  if (w[0] === 'T.' && w[1] === 'Rowe') return 'T. Rowe Price';
  // "Goldman Sachs" â€” ë°œí–‰ì‚¬ë¡œ í‘œê¸°
  if (w[0] === 'Goldman' && w[1] === 'Sachs') return 'Goldman Sachs Asset Management';
  // "BNY Mellon" â€” ë°œí–‰ì‚¬ë¡œ í‘œê¸°
  if (w[0] === 'BNY' && w[1] === 'Mellon') return 'BNY Mellon';
  return _ISSUER_PREFIX[w[0]] || '';
}

// ì„¹í„° ID â†’ ì´ë¦„ ë§¤í•‘ (ê°„ì†Œí™”)
const SECTOR_NAMES = {
  S01:'ğŸ“ˆ US ëŒ€í˜•ì£¼',S02:'ğŸ’» í…Œí¬ë†€ë¡œì§€',S03:'ğŸ¥ í—¬ìŠ¤ì¼€ì–´',S04:'ğŸ¦ ê¸ˆìœµ',S05:'ğŸ›ï¸ ê²½ê¸°ì†Œë¹„ì¬',
  S06:'ğŸ›’ í•„ìˆ˜ì†Œë¹„ì¬',S07:'ğŸ­ ì‚°ì—…ì¬',S08:'âš¡ ìœ í‹¸ë¦¬í‹°',S09:'ğŸ“¡ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜',S10:'â›ï¸ ì†Œì¬',
  S11:'ğŸŒ êµ­ì œì„ ì§„êµ­',S12:'ğŸŒ ì‹ í¥êµ­',S13:'ğŸ“Š ì¤‘ì†Œí˜•ì£¼',S14:'ğŸ›ï¸ íˆ¬ìë“±ê¸‰ì±„ê¶Œ',S15:'ğŸ’µ ë‹¨ê¸°ì±„/í˜„ê¸ˆì„±',
  S16:'âš ï¸ í•˜ì´ì¼ë“œ',S17:'ğŸ“ˆ TIPS/ì¸í”Œë ˆì´ì…˜',S18:'âœ¨ ê¸ˆ/ê·€ê¸ˆì†',S19:'ğŸ›¢ï¸ ì—ë„ˆì§€/ì›ìì¬',
  S20:'ğŸ˜ï¸ ë¶€ë™ì‚°/REITs',S21:'â‚¿ ê°€ìƒìì‚°',S22:'ğŸ“‰ ì¸ë²„ìŠ¤/ìˆ',S24:'ğŸ§© í…Œë§ˆ/íŠ¹ìˆ˜ëª©ì '
};

// â”€â”€ URLì—ì„œ ticker ì¶”ì¶œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const params = new URLSearchParams(location.search);
const TICKER = (params.get('ticker') || 'SPY').toUpperCase().trim();

document.getElementById('nav-breadcrumb').textContent = '/ ' + TICKER;
// ë°±í…ŒìŠ¤íŠ¸ ë§í¬ì— í˜„ì¬ í‹°ì»¤ë¥¼ 100% ë¹„ì¤‘ìœ¼ë¡œ í”„ë¦¬ì…‹
document.getElementById('nav-backtest-link').href = `/backtest?portfolio=${TICKER}:100`;
document.title = TICKER + ' ETF ìƒì„¸ â€” CORRYU';

// â”€â”€ Watchlist (localStorage) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const watchlist = new Set(JSON.parse(localStorage.getItem('corryu_watchlist') || '[]'));
function toggleWatchlist() {
  if (watchlist.has(TICKER)) watchlist.delete(TICKER);
  else watchlist.add(TICKER);
  localStorage.setItem('corryu_watchlist', JSON.stringify([...watchlist]));
  updateStarBtn();
}
function updateStarBtn() {
  const btn = document.getElementById('star-hero-btn');
  if (!btn) return;
  if (watchlist.has(TICKER)) {
    btn.textContent = 'â˜… ê´€ì‹¬ì¢…ëª©';
    btn.classList.add('starred');
  } else {
    btn.textContent = 'â˜† ê´€ì‹¬ì¢…ëª© ì¶”ê°€';
    btn.classList.remove('starred');
  }
}

// â”€â”€ ê²€ìƒ‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('nav-search-input').addEventListener('keydown', e => {
  if (e.key === 'Enter') goToTicker();
});
function goToTicker() {
  const val = document.getElementById('nav-search-input').value.trim().toUpperCase();
  if (val) location.href = '/etf-detail?ticker=' + encodeURIComponent(val);
}


// â”€â”€ ë Œë”ë§ í•¨ìˆ˜ë“¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function fmtAUM(v) {
  if (!v) return 'â€”';
  const m = v / 1e6;
  return m >= 1000 ? '$' + (m/1000).toFixed(1) + 'B' : '$' + Math.round(m) + 'M';
}
function fmtPct(v, dec=1) {
  if (v === null || v === undefined) return 'â€”';
  return (v > 0 ? '+' : '') + v.toFixed(dec) + '%';
}
function fmtNum(v, dec=2) {
  if (v === null || v === undefined) return 'â€”';
  return v.toFixed(dec);
}
function fmtExpRatio(v) {
  if (v === null || v === undefined) return '';
  // vëŠ” ì†Œìˆ˜ í˜•ì‹ (ì˜ˆ: 0.0003 â†’ "0.03%")
  const pct = v * 100;
  return pct < 0.01 ? pct.toFixed(4) + '%' : pct.toFixed(2) + '%';
}
function metricColor(key, val) {
  if (val === null || val === undefined) return 'val-neutral';
  if (key === 'z_score')   return val <= -1.5 ? 'val-neg' : val >= 2.0 ? 'val-pos' : 'val-neutral';
  if (key === 'rsi')       return val <= 30 ? 'val-neg' : val >= 70 ? 'val-pos' : 'val-neutral';
  if (key === 'range_52w') return val <= 20 ? 'val-neg' : val >= 80 ? 'val-pos' : 'val-neutral';
  if (key === 'ma200_pct') return val <= -10 ? 'val-neg' : val >= 15 ? 'val-pos' : 'val-neutral';
  if (key === 'mdd_52w')   return val <= -20 ? 'val-pos' : 'val-neutral';
  if (key === 'cagr')      return val >= 15 ? 'val-good' : val < 0 ? 'val-pos' : 'val-neutral';
  if (key === 'sortino')   return val >= 1.2 ? 'val-purple' : val < 0 ? 'val-pos' : 'val-neutral';
  if (key === 'r_anchor')  return Math.abs(val) >= 0.7 ? 'val-pos' : 'val-neutral';
  return 'val-neutral';
}

function renderGauge(val, min, max, color) {
  const pct = Math.max(0, Math.min(100, ((val - min) / (max - min)) * 100));
  return `<div class="gauge-wrap"><div class="gauge-bar"><div class="gauge-fill" style="width:${pct.toFixed(1)}%;background:${color}"></div></div></div>`;
}

function renderPage(etf, sectorId) {
  currentETF = etf;
  const supp = SUPP[etf.ticker] || {};
  const sector = SECTOR_NAMES[sectorId] || sectorId || 'â€”';

  // â”€â”€ Hero â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  document.getElementById('h-ticker').textContent = etf.ticker;
  document.getElementById('h-ticker').style.color = '#e2e8f0';
  document.getElementById('h-name').textContent   = etf.name;
  document.getElementById('h-aum').textContent     = fmtAUM(etf.aum);
  document.getElementById('h-desc').textContent    = supp.desc || I18n.t('detail.desc.pending');
  document.getElementById('h-datadate').textContent = '2026-02-26';
  document.getElementById('note-datadate').textContent = '2026-02-26';

  const badgesHtml =
    `<span class="badge badge-sector">${sector}</span>` +
    (etf.is_legacy ? '<span class="badge badge-legacy">Legacy</span>' : '<span class="badge badge-active">Active</span>') +
    (etf.short_history ? `<span class="badge badge-short">${I18n.t('detail.short.badge')}</span>` : '');
  document.getElementById('h-badges').innerHTML = badgesHtml;
  updateStarBtn();

  // â”€â”€ Quick Stats â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  document.getElementById('qs-exp').textContent      = supp.exp      || fmtExpRatio(etf.exp_ratio) || I18n.t('detail.data.pending');
  document.getElementById('qs-inception').textContent = (etf.inception && etf.inception !== '1900-01-01') ? etf.inception : 'â€”';
  document.getElementById('qs-issuer').textContent   = supp.issuer   || inferIssuer(etf.name) || I18n.t('detail.data.pending');
  document.getElementById('qs-bench').textContent    = supp.bench    || I18n.t('detail.data.pending');
  document.getElementById('qs-numh').textContent     = supp.numH !== undefined ? I18n.t('detail.numh.format', { n: supp.numH.toLocaleString() }) : 'â€”';

  // â”€â”€ ì°¨íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (priceHistory) initPriceChart(document.getElementById('chart-container'), priceHistory, currentChartType);
  document.getElementById('chart-cagr').textContent = fmtPct(etf.cagr);
  document.getElementById('chart-vol').textContent  = fmtPct(etf.vol);

  // â”€â”€ ê¸°ê°„ë³„ ìˆ˜ìµë¥  (ì‹¤ë°ì´í„° ë¡œë“œ í›„ updatePerfFromHistory()ë¡œ ê°±ì‹ ) â”€â”€
  if (priceHistory) {
    updatePerfFromHistory();
  } else {
    const perfPeriods = [
      { key: '1M',     labelKey: 'detail.perf.period.1M',    ann: false },
      { key: '3M',     labelKey: 'detail.perf.period.3M',    ann: false },
      { key: 'YTD',    labelKey: 'detail.perf.period.YTD',   ann: false },
      { key: '1Y',     labelKey: 'detail.perf.period.1Y',    ann: false },
      { key: '3Y_ann', labelKey: 'detail.perf.period.3Y_ann',ann: true },
      { key: '5Y_ann', labelKey: 'detail.perf.period.5Y_ann',ann: true },
    ];
    document.getElementById('perf-table-body').innerHTML = perfPeriods.map(p => {
      const annLabel = p.ann ? I18n.t('detail.perf.ann') : I18n.t('detail.perf.accumulated');
      return `<tr>
        <td class="perf-period">${I18n.t(p.labelKey)}</td>
        <td class="ret-na">â€”</td>
        <td style="color:var(--text-muted);font-size:0.75rem">${annLabel}</td>
      </tr>`;
    }).join('');
  }

  // â”€â”€ ìƒìœ„ êµ¬ì„±ì¢…ëª© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const holdings = supp.holdings;
  let holdHtml = '';
  if (!holdings || holdings.length === 0) {
    holdHtml = `<div style="text-align:center;padding:24px;color:var(--text-muted);font-size:0.85rem">${I18n.t('detail.holdings.empty')}</div>`;
  } else {
    const maxW = Math.max(...holdings.map(h => h[2]));
    holdHtml = holdings.map(([tk, nm, wt], i) =>
      `<div class="holding-row">
        <span class="holding-rank">${i+1}</span>
        <span class="holding-ticker">${tk}</span>
        <span class="holding-name">${nm}</span>
        <div class="holding-bar-wrap">
          <div class="holding-bar-bg"><div class="holding-bar" style="width:${(wt/maxW*100).toFixed(1)}%"></div></div>
        </div>
        <span class="holding-weight">${wt.toFixed(2)}%</span>
      </div>`
    ).join('');
    const top10Sum = holdings.reduce((s, h) => s + h[2], 0);
    holdHtml += `<div class="holdings-footer">
      <span>${I18n.t('detail.holdings.sum', { pct: top10Sum.toFixed(1) })}</span>
      <span>${I18n.t('detail.holdings.total', { n: (supp.numH || '?').toLocaleString() })}</span>
    </div>`;
  }
  document.getElementById('holdings-container').innerHTML = holdHtml;

  // â”€â”€ ë¶„ì„ ì§€í‘œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const metrics = [
    { label: 'Z-Score', key: 'z_score',   val: etf.short_history ? null : etf.z_score,   fmt: v => fmtNum(v, 2),   gauge: [v => renderGauge(v, -3, 3, '#3b82f6')] },
    { label: I18n.t('detail.metric.rsi'), key: 'rsi',     val: etf.rsi,           fmt: v => fmtNum(v, 0) + '  ', gauge: [v => renderGauge(v, 0, 100, '#f59e0b')] },
    { label: '52W Range', key: 'range_52w', val: etf.range_52w,    fmt: v => fmtNum(v, 0) + '%',  gauge: [v => renderGauge(v, 0, 100, '#8b5cf6')] },
    { label: I18n.t('detail.metric.ma200'), key: 'ma200_pct', val: etf.short_history ? null : etf.ma200_pct, fmt: v => fmtPct(v), gauge: [] },
    { label: '52W MDD',   key: 'mdd_52w',  val: etf.short_history ? null : etf.mdd_52w,  fmt: v => fmtPct(v), gauge: [] },
    { label: 'r_Anchor',  key: 'r_anchor', val: etf.r_anchor,      fmt: v => fmtNum(v, 2), gauge: [] },
    { label: 'SMH Corr',  key: 'smh_corr', val: etf.smh_corr,      fmt: v => v !== null && v !== undefined ? fmtNum(v, 2) : 'â€”', gauge: [] },
    { label: 'CAGR',      key: 'cagr',     val: etf.short_history ? null : etf.cagr,     fmt: v => fmtPct(v), gauge: [] },
    { label: I18n.t('detail.metric.vol'), key: 'vol',  val: etf.short_history ? null : etf.vol,      fmt: v => fmtPct(v, 1), gauge: [] },
    { label: 'Sortino',   key: 'sortino',  val: etf.short_history ? null : etf.sortino,  fmt: v => fmtNum(v, 2), gauge: [] },
  ];
  const metricsHtml = metrics.map(m => {
    const display = m.val === null || m.val === undefined ? 'â€”' : m.fmt(m.val);
    const cls     = m.val !== null && m.val !== undefined ? metricColor(m.key, m.val) : 'val-neutral';
    return `<div class="metric-row">
      <span class="metric-label">${m.label}</span>
      <span class="metric-value ${cls}">${display}</span>
    </div>`;
  }).join('');
  document.getElementById('metrics-container').innerHTML = metricsHtml;

  // â”€â”€ í€ë“œ ì •ë³´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const infoRows = [
    { label: 'Rank',                           val: etf.rank === 9999 ? 'â€”' : ('#' + etf.rank) },
    { label: 'AUM',                            val: fmtAUM(etf.aum) },
    { label: I18n.t('detail.info.fee'),        val: supp.exp       || fmtExpRatio(etf.exp_ratio) || 'â€”' },
    { label: I18n.t('detail.info.issuer'),     val: supp.issuer    || inferIssuer(etf.name) || 'â€”' },
    { label: I18n.t('detail.info.structure'),  val: supp.structure || 'â€”' },
    { label: I18n.t('detail.info.div'),        val: supp.div       || 'â€”' },
    { label: I18n.t('detail.info.divyield'),   val: supp.divYield  || 'â€”' },
    { label: I18n.t('detail.info.bench'),      val: supp.bench     || 'â€”' },
    { label: I18n.t('detail.info.inception'),  val: (etf.inception && etf.inception !== '1900-01-01') ? etf.inception : 'â€”' },
    { label: I18n.t('detail.info.sector'),     val: sector },
    { label: 'Status',                         val: etf.is_legacy ? (etf._user_override ? 'User Legacy' : 'Legacy') : 'Active' },
  ];
  const infoHtml = infoRows.map(r =>
    `<div class="info-row"><span class="info-label">${r.label}</span><span class="info-value">${r.val}</span></div>`
  ).join('');
  document.getElementById('fund-info-container').innerHTML = infoHtml;

  // â”€â”€ ë¹„êµí•˜ê¸° ë²„íŠ¼ URL ì„¸íŒ… â”€â”€
  const compareLink = document.getElementById('compare-hero-link');
  if (compareLink) compareLink.href = '/compare?tickers=' + encodeURIComponent(etf.ticker);

  // â”€â”€ ì„œë¸Œì°¨íŠ¸ ì´ˆê¸°í™” â”€â”€
  // short_history ETFëŠ” Z-Score ì—†ìŒ â€” zscore ì„œë¸Œì°¨íŠ¸ ë¹„í™œì„±í™”
  if (etf.short_history) activeIndicators.zscore = false;
  const zchk = document.getElementById('ind-zscore');
  if (zchk) zchk.checked = activeIndicators.zscore;
  buildSubCharts();

  // í˜ì´ì§€ í‘œì‹œ
  document.getElementById('loading-state').style.display = 'none';
  document.getElementById('page-content').style.display = 'block';
}


// â”€â”€ ë°ì´í„° ë¡œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
fetch('/etf_data.json')
  .then(r => { if (!r.ok) throw new Error('fetch failed'); return r.json(); })
  .then(data => {
    let found = null, foundSid = null;
    for (const [sid, etfs] of Object.entries(data.allData || data)) {
      if (!Array.isArray(etfs)) continue;
      const e = etfs.find(x => x.ticker === TICKER);
      if (e) { found = e; foundSid = sid; break; }
    }
    if (!found) {
      document.getElementById('loading-state').style.display = 'none';
      document.getElementById('error-title').textContent = '"' + TICKER + '" ' + I18n.t('detail.not.found');
      document.getElementById('error-msg').textContent   = I18n.t('detail.error.notfound.msg');
      document.getElementById('error-state').style.display = 'flex';
      return;
    }
    // localStorage ì˜¤ë²„ë¼ì´ë“œ ë°˜ì˜ (ì½ê¸° ì „ìš©)
    const ov = JSON.parse(localStorage.getItem('corryu_user_overrides') || '{}');
    if (ov[TICKER]) {
      if ('is_legacy' in ov[TICKER]) found.is_legacy = ov[TICKER].is_legacy;
      if (ov[TICKER].is_legacy) found._user_override = true;
    }
    renderPage(found, foundSid);
    loadPriceHistory(found.ticker).then(hist => {
      if (hist) {
        priceHistory = hist;
        initPriceChart(document.getElementById('chart-container'), hist, currentChartType);
        updatePerfFromHistory();
        buildSubCharts();
      }
    });
    I18n.init();
    document.addEventListener('i18n:ready', () => {
      if (currentETF) {
        renderPage(currentETF, foundSid);
        if (priceHistory) {
          initPriceChart(document.getElementById('chart-container'), priceHistory, currentChartType);
          updatePerfFromHistory();
          buildSubCharts();
        }
      }
    });
  })
  .catch(() => {
    document.getElementById('loading-state').style.display = 'none';
    document.getElementById('error-title').textContent = I18n.t('detail.error.load.title');
    document.getElementById('error-msg').textContent   = I18n.t('detail.error.load.msg');
    document.getElementById('error-state').style.display = 'flex';
  });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ’¬ ëŒ“ê¸€ ì‹œìŠ¤í…œ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(async function initComments() {
  const section = document.getElementById('comment-section');
  section.style.display = 'block';

  // Supabase ë¯¸ì—°ê²° ìƒíƒœ
  if (!CorryuAuth.isConfigured) {
    document.getElementById('c-not-configured').style.display = 'block';
    return;
  }

  // â”€â”€ ì•„ë°”íƒ€ ìƒ‰ìƒ íŒ”ë ˆíŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const AVATAR_COLORS = [
    '#3b82f6','#8b5cf6','#f59e0b','#22c55e','#ef4444',
    '#0ea5e9','#f97316','#a855f7','#06b6d4','#84cc16',
  ];
  function nickColor(nick) {
    let h = 0; for (const c of nick) h = (Math.imul(31,h)+c.charCodeAt(0))|0;
    return AVATAR_COLORS[Math.abs(h) % AVATAR_COLORS.length];
  }

  // â”€â”€ ì‹œê°„ í¬ë§· â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function timeAgo(iso) {
    const diff = (Date.now() - new Date(iso)) / 1000;
    if (diff < 60)       return 'ë°©ê¸ˆ ì „';
    if (diff < 3600)     return Math.floor(diff/60) + 'ë¶„ ì „';
    if (diff < 86400)    return Math.floor(diff/3600) + 'ì‹œê°„ ì „';
    if (diff < 604800)   return Math.floor(diff/86400) + 'ì¼ ì „';
    return new Date(iso).toLocaleDateString('ko-KR', {year:'numeric',month:'2-digit',day:'2-digit'}).replace(/\. /g,'.').replace('.','');
  }

  // â”€â”€ HTML ì´ìŠ¤ì¼€ì´í”„ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function esc(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

  // â”€â”€ ìƒíƒœ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  let currentUser = null;
  let currentProfile = null;
  let myVotes = {}; // {comment_id: 'like'|'dislike'}
  let comments = [];
  let sortBy = 'recent'; // 'recent' | 'likes'
  let offset = 0;
  const PAGE_SIZE = 20;
  const GUEST_LIMIT = 3; // ë¹„ë¡œê·¸ì¸ ì‹œ ë³´ì—¬ì¤„ ìµœëŒ€ ìˆ˜

  // â”€â”€ ë¡œê·¸ì¸ ìƒíƒœ ì´ˆê¸°í™” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  currentUser = await CorryuAuth.getUser();
  if (currentUser) {
    currentProfile = await CorryuAuth.getProfile(currentUser.id);
    showWriteForm();
    await loadMyVotes();
  } else {
    document.getElementById('c-login-banner').style.display = 'block';
  }

  // ë¬¸ì ìˆ˜ ì¹´ìš´í„°
  document.getElementById('c-textarea')?.addEventListener('input', function() {
    document.getElementById('c-char-count').textContent = this.value.length + ' / 2000';
  });

  // â”€â”€ ë‚´ íˆ¬í‘œ ë‚´ì—­ ë¡œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  async function loadMyVotes() {
    if (!currentUser) return;
    const { data } = await _sb.from('comment_votes')
      .select('comment_id, vote_type').eq('user_id', currentUser.id);
    if (data) data.forEach(v => myVotes[v.comment_id] = v.vote_type);
  }

  // â”€â”€ ëŒ“ê¸€ ë¡œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  async function loadComments(reset = false) {
    if (reset) { comments = []; offset = 0; }

    let q = _sb.from('comments')
      .select('*')
      .eq('ticker', TICKER)
      .is('parent_id', null)
      .eq('is_deleted', false);

    if (sortBy === 'likes') q = q.order('likes', { ascending: false }).order('created_at', { ascending: false });
    else                    q = q.order('created_at', { ascending: false });

    const limit = currentUser ? PAGE_SIZE : GUEST_LIMIT + 1;
    q = q.range(offset, offset + limit - 1);

    const { data, error } = await q;
    if (error) { console.error('[CORRYU comments]', error); return; }

    // ê° ìƒìœ„ ëŒ“ê¸€ì˜ ë‹µê¸€ ë¡œë“œ
    if (data && data.length > 0) {
      const ids = data.map(c => c.id);
      const { data: replies } = await _sb.from('comments')
        .select('*').in('parent_id', ids).eq('is_deleted', false)
        .order('created_at', { ascending: true });

      const replyMap = {};
      (replies || []).forEach(r => {
        if (!replyMap[r.parent_id]) replyMap[r.parent_id] = [];
        replyMap[r.parent_id].push(r);
      });
      data.forEach(c => c.replies = replyMap[c.id] || []);
    }

    if (reset) comments = data || [];
    else       comments = comments.concat(data || []);
    offset += data?.length || 0;

    renderComments(data?.length || 0, limit);
    await updateTotal();
  }

  // â”€â”€ ì „ì²´ ëŒ“ê¸€ ìˆ˜ ì—…ë°ì´íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  async function updateTotal() {
    const { count } = await _sb.from('comments')
      .select('*', { count: 'exact', head: true })
      .eq('ticker', TICKER).eq('is_deleted', false).is('parent_id', null);
    document.getElementById('c-total-badge').textContent = count ?? 0;
  }

  // â”€â”€ ëŒ“ê¸€ ë Œë”ë§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function renderComments(fetchedCount, limit) {
    const list = document.getElementById('c-list');
    const empty = document.getElementById('c-empty');
    const gate  = document.getElementById('c-guest-gate');
    const more  = document.getElementById('c-load-more');

    if (comments.length === 0) {
      list.innerHTML = ''; empty.style.display = 'block'; gate.style.display = 'none'; more.style.display = 'none'; return;
    }
    empty.style.display = 'none';

    // ê²ŒìŠ¤íŠ¸ ì œí•œ
    const display = currentUser ? comments : comments.slice(0, GUEST_LIMIT);
    const hasMore  = currentUser ? (fetchedCount >= limit) : (comments.length > GUEST_LIMIT);

    list.innerHTML = display.map(c => renderTopComment(c)).join('');

    gate.style.display = (!currentUser && comments.length >= GUEST_LIMIT) ? 'block' : 'none';
    more.style.display = (currentUser && hasMore) ? 'block' : 'none';
  }

  function renderTopComment(c) {
    const color = nickColor(c.nickname);
    const myVote = myVotes[c.id];
    const isOwn = currentUser && currentUser.id === c.user_id;
    const repliesHtml = (c.replies || []).map(r => renderReply(r)).join('');
    const replyCount = c.replies?.length || 0;
    return `<div class="c-item" id="c-${c.id}">
      <div style="display:flex;gap:10px;align-items:flex-start">
        <div class="c-avatar" style="background:${color}">${esc(c.nickname.charAt(0).toUpperCase())}</div>
        <div style="flex:1;min-width:0">
          <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
            <span class="c-nick">${esc(c.nickname)}</span>
            <span class="c-time">${timeAgo(c.created_at)}</span>
            ${isOwn ? `<button class="c-del-btn" onclick="deleteComment('${c.id}',false)">ì‚­ì œ</button>` : ''}
          </div>
          <div class="c-body">${esc(c.content)}</div>
          <div class="c-action-row">
            <button class="c-vote-btn ${myVote==='like'?'voted-like':''}" onclick="vote('${c.id}','like')">
              ğŸ‘ <span id="lk-${c.id}">${c.likes}</span>
            </button>
            <button class="c-vote-btn ${myVote==='dislike'?'voted-dislike':''}" onclick="vote('${c.id}','dislike')">
              ğŸ‘ <span id="dk-${c.id}">${c.dislikes}</span>
            </button>
            ${currentUser ? `<button class="c-reply-toggle" onclick="toggleReplyForm('${c.id}')">ğŸ’¬ ë‹µê¸€</button>` : ''}
            ${replyCount > 0 ? `<span class="c-reply-count">${replyCount}ê°œ ë‹µê¸€</span>` : ''}
          </div>
          <!-- ë‹µê¸€ ì‘ì„± í¼ -->
          <div id="rf-${c.id}" style="display:none;margin-top:10px">
            <div class="c-reply-form" style="margin-left:0">
              <textarea class="c-reply-textarea" id="rt-${c.id}" placeholder="ë‹µê¸€ì„ ì‘ì„±í•˜ì„¸ìš”â€¦" maxlength="2000"></textarea>
              <div style="display:flex;flex-direction:column;gap:5px">
                <button class="c-reply-submit" onclick="submitReply('${c.id}')">ë“±ë¡</button>
                <button class="c-reply-cancel" onclick="toggleReplyForm('${c.id}')">ì·¨ì†Œ</button>
              </div>
            </div>
          </div>
          <!-- ë‹µê¸€ ëª©ë¡ -->
          <div class="c-replies-list" id="rl-${c.id}" style="${replyCount===0?'display:none':'display:block'}">${repliesHtml}</div>
        </div>
      </div>
    </div>`;
  }

  function renderReply(r) {
    const color = nickColor(r.nickname);
    const myVote = myVotes[r.id];
    const isOwn = currentUser && currentUser.id === r.user_id;
    return `<div class="c-reply-item-inner" id="c-${r.id}">
      <div style="display:flex;gap:8px;align-items:flex-start">
        <div class="c-avatar" style="width:28px;height:28px;font-size:.72rem;background:${color}">${esc(r.nickname.charAt(0).toUpperCase())}</div>
        <div style="flex:1;min-width:0">
          <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
            <span class="c-nick" style="font-size:.8rem">${esc(r.nickname)}</span>
            <span class="c-time">${timeAgo(r.created_at)}</span>
            ${isOwn ? `<button class="c-del-btn" onclick="deleteComment('${r.id}',true)">ì‚­ì œ</button>` : ''}
          </div>
          <div class="c-body" style="font-size:.82rem">${esc(r.content)}</div>
          <div class="c-action-row">
            <button class="c-vote-btn ${myVote==='like'?'voted-like':''}" onclick="vote('${r.id}','like')">
              ğŸ‘ <span id="lk-${r.id}">${r.likes}</span>
            </button>
            <button class="c-vote-btn ${myVote==='dislike'?'voted-dislike':''}" onclick="vote('${r.id}','dislike')">
              ğŸ‘ <span id="dk-${r.id}">${r.dislikes}</span>
            </button>
          </div>
        </div>
      </div>
    </div>`;
  }

  // â”€â”€ ì‘ì„± í¼ í‘œì‹œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function showWriteForm() {
    const form = document.getElementById('c-write-form');
    const av   = document.getElementById('c-my-avatar');
    form.style.display = 'block';
    if (currentProfile) {
      const color = nickColor(currentProfile.nickname);
      av.style.background = color;
      av.textContent = currentProfile.nickname.charAt(0).toUpperCase();
    }
  }

  // â”€â”€ ëŒ“ê¸€ ë“±ë¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  window.submitTopComment = async function() {
    if (!currentUser || !currentProfile) return;
    const ta = document.getElementById('c-textarea');
    const content = ta.value.trim();
    if (!content) return;
    const { error } = await _sb.from('comments').insert({
      ticker: TICKER, user_id: currentUser.id, nickname: currentProfile.nickname,
      content, parent_id: null, depth: 0,
    });
    if (error) { alert('ë“±ë¡ ì‹¤íŒ¨: ' + error.message); return; }
    ta.value = ''; document.getElementById('c-char-count').textContent = '0 / 2000';
    await loadComments(true);
  };

  // â”€â”€ ë‹µê¸€ í¼ í† ê¸€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  window.toggleReplyForm = function(parentId) {
    const form = document.getElementById('rf-' + parentId);
    form.style.display = form.style.display === 'none' ? 'block' : 'none';
    if (form.style.display === 'block') document.getElementById('rt-' + parentId)?.focus();
  };

  // â”€â”€ ë‹µê¸€ ë“±ë¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  window.submitReply = async function(parentId) {
    if (!currentUser || !currentProfile) return;
    const ta = document.getElementById('rt-' + parentId);
    const content = ta?.value.trim();
    if (!content) return;
    const { error } = await _sb.from('comments').insert({
      ticker: TICKER, user_id: currentUser.id, nickname: currentProfile.nickname,
      content, parent_id: parentId, depth: 1,
    });
    if (error) { alert('ë“±ë¡ ì‹¤íŒ¨: ' + error.message); return; }
    ta.value = '';
    document.getElementById('rf-' + parentId).style.display = 'none';
    await loadComments(true);
  };

  // â”€â”€ ëŒ“ê¸€ ì‚­ì œ (ì†Œí”„íŠ¸) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  window.deleteComment = async function(id, isReply) {
    if (!confirm('ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
    await _sb.from('comments').update({ is_deleted: true }).eq('id', id);
    await loadComments(true);
  };

  // â”€â”€ ì¢‹ì•„ìš” / ì‹«ì–´ìš” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  window.vote = async function(commentId, type) {
    if (!currentUser) { goLogin(); return; }
    const prev = myVotes[commentId];
    const lkEl = document.getElementById('lk-' + commentId);
    const dkEl = document.getElementById('dk-' + commentId);

    if (prev === type) {
      // ê°™ì€ ë²„íŠ¼ â†’ ì·¨ì†Œ
      await _sb.from('comment_votes').delete()
        .eq('comment_id', commentId).eq('user_id', currentUser.id);
      delete myVotes[commentId];
    } else {
      // ìƒˆ íˆ¬í‘œ ë˜ëŠ” ë³€ê²½
      await _sb.from('comment_votes').upsert(
        { comment_id: commentId, user_id: currentUser.id, vote_type: type },
        { onConflict: 'comment_id,user_id' }
      );
      myVotes[commentId] = type;
    }

    // ìµœì‹  ì¹´ìš´íŠ¸ ê°€ì ¸ì˜¤ê¸°
    const { data } = await _sb.from('comments').select('likes,dislikes').eq('id', commentId).single();
    if (data && lkEl && dkEl) { lkEl.textContent = data.likes; dkEl.textContent = data.dislikes; }

    // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
    const lkBtn = document.querySelector(`#c-${commentId} .c-vote-btn:first-child`);
    const dkBtn = document.querySelector(`#c-${commentId} .c-vote-btn:nth-child(2)`);
    lkBtn?.classList.toggle('voted-like',    myVotes[commentId] === 'like');
    dkBtn?.classList.toggle('voted-dislike', myVotes[commentId] === 'dislike');
  };

  // â”€â”€ ì •ë ¬ ì „í™˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  window.setSortBy = function(s) {
    sortBy = s;
    document.querySelectorAll('.c-sort-btn').forEach(b => b.classList.toggle('c-sort-on', b.dataset.sort === s));
    loadComments(true);
  };

  // â”€â”€ ë” ë³´ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  window.loadMoreComments = function() { loadComments(false); };

  // â”€â”€ ë¡œê·¸ì¸ ë¦¬ë””ë ‰ì…˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  window.goLogin = function(e) {
    e?.preventDefault();
    location.href = '/login?redirect=' + encodeURIComponent(location.href);
  };

  // â”€â”€ ìµœì´ˆ ë¡œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  await loadComments(true);

  // â”€â”€ ì‹¤ì‹œê°„ êµ¬ë… (ìƒˆ ëŒ“ê¸€ ì•Œë¦¼) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  _sb.channel('comments:' + TICKER)
    .on('postgres_changes',
      { event: 'INSERT', schema: 'public', table: 'comments', filter: 'ticker=eq.' + TICKER },
      () => { loadComments(true); }
    ).subscribe();

})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// â¤ï¸ ì¢…ëª© ì¢‹ì•„ìš” ì‹œìŠ¤í…œ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(async function initTickerLike() {
  if (!CorryuAuth.isConfigured) return;

  const btn   = document.getElementById('tl-btn');
  const icon  = document.getElementById('tl-icon');
  const countEl = document.getElementById('tl-count');

  let liked = false;
  let currentUser = null;

  // â”€â”€ ì¢‹ì•„ìš” ìˆ˜ ì¡°íšŒ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  async function fetchCount() {
    const { count } = await _sb.from('ticker_likes')
      .select('id', { count: 'exact', head: true })
      .eq('ticker', TICKER);
    return count ?? 0;
  }

  // â”€â”€ ë³¸ì¸ ì¢‹ì•„ìš” ì—¬ë¶€ ì¡°íšŒ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  async function fetchMyLike(userId) {
    const { data } = await _sb.from('ticker_likes')
      .select('id').eq('ticker', TICKER).eq('user_id', userId).maybeSingle();
    return !!data;
  }

  // â”€â”€ UI ì—…ë°ì´íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function updateUI(count, isLiked) {
    countEl.textContent = count;
    if (isLiked) {
      btn.style.background   = 'rgba(244,114,182,0.18)';
      btn.style.borderColor  = 'rgba(244,114,182,0.55)';
      btn.style.color        = '#f472b6';
      icon.setAttribute('fill', '#f472b6');
      icon.setAttribute('stroke', '#f472b6');
    } else {
      btn.style.background   = 'rgba(244,114,182,0.07)';
      btn.style.borderColor  = 'rgba(244,114,182,0.25)';
      btn.style.color        = '#94a3b8';
      icon.setAttribute('fill', 'none');
      icon.setAttribute('stroke', 'currentColor');
    }
    btn.style.display = 'inline-flex';
  }

  // â”€â”€ ìµœì´ˆ ë¡œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  currentUser = await CorryuAuth.getUser();
  const [count, myLike] = await Promise.all([
    fetchCount(),
    currentUser ? fetchMyLike(currentUser.id) : Promise.resolve(false),
  ]);
  liked = myLike;
  updateUI(count, liked);

  // â”€â”€ ì¢‹ì•„ìš” í† ê¸€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  window.tickerLikeToggle = async function() {
    if (!currentUser) {
      location.href = '/login?redirect=' + encodeURIComponent(location.href);
      return;
    }
    btn.disabled = true;
    try {
      if (liked) {
        await _sb.from('ticker_likes').delete()
          .eq('ticker', TICKER).eq('user_id', currentUser.id);
      } else {
        await _sb.from('ticker_likes').insert({ ticker: TICKER, user_id: currentUser.id });
      }
      liked = !liked;
      const newCount = await fetchCount();
      updateUI(newCount, liked);
    } catch(e) {
      console.warn('[CORRYU] ticker like error:', e.message);
    } finally {
      btn.disabled = false;
    }
  };

  // â”€â”€ Auth ìƒíƒœ ë³€í™” ê°ì§€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  CorryuAuth.onAuthChange(async (_event, session) => {
    currentUser = session?.user ?? null;
    const myLike = currentUser ? await fetchMyLike(currentUser.id) : false;
    liked = myLike;
    const count = await fetchCount();
    updateUI(count, liked);
  });
})();
</script>
</body>
</html>
